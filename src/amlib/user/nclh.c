#include "nimbus.h"
#include "amlib.h"

const int NTEMPS = 31, NPRESSURES = 102;        // pmatrix dimensions

static double Tgrid[31], Pgrid[102];		// Temperature and Pressure grids
static double H2O_vmr_s, H2O_vmr_h;		// Final water vapor mixing ratio variables
static double Pair, Tair;			// System pressure and temperature
static double P_default, T_default;		// Default P/T if sensors fail

static const double Pa0_s = 1.91503;		// Constant
static const double Pa1_s = -0.00295;		// Linear
static const double Pa2_s = 2.90483e-6;		// Quadratic
static const double Pa3_s = -1.17932e-9;	// Cubic
static const double Pa4_s = 0.0;		// Quartic

static const double Pa0_h = 2.18378;		// Constant
static const double Pa1_h = -0.00406;		// Linear
static const double Pa2_h = 3.94328e-6;		// Quadratic
static const double Pa3_h = -1.4132e-9;		// Cubic
static const double Pa4_h = 0.0;		// Quartic

static const double Tlower = 170.0;		// Lower T for matrix generation
static const double Tupper = 320.0;		// Upper T for matrix generation
static const double Plower = 100.0;		// Lower P for matrix generation
static const double Pupper = 1100.0;		// Upper P for matrix generation
static const double Wlower = 7305.751953;	// Lower P for matrix generation
static const double Wupper = 7307.751953;	// Upper P for matrix generation
static const double imodcalc = 2098.547119;	// Modulation amp. (peak) in cm-1
static const double vmrref_s = 3000.0;		// Reference vmr for calculati
static const double vmrref_h = 100.0;		// Reference vmr for calculati

static const double Rcalb_s = 12.43;
static const double Rcalb_h = 3.694;		// Response numbers (from calibrations)

static const double c0_h = 68.60169;
static const double c1_h = 0.69185;
static const double c2_h = 3.09883e-4;

static const double pmatrix_s[NPRESSURES][NTEMPS] = {
 0.070808, 0.066409, 0.062329, 0.058544, 0.055032, 0.051768, 0.048735, 0.045914, 0.043289,
 0.040844, 0.038565, 0.036439, 0.034455, 0.032602, 0.030870, 0.029250, 0.027733, 0.026313,
 0.024981, 0.023732, 0.022560, 0.021458, 0.020423, 0.019449, 0.018531, 0.017668, 0.016853,
 0.016085, 0.015360, 0.014676, 0.014028, 0.072721, 0.068298, 0.064188, 0.060366, 0.056811,
 0.053503, 0.050424, 0.047558, 0.044886, 0.042394, 0.040068, 0.037896, 0.035866, 0.033967,
 0.032190, 0.030526, 0.028967, 0.027504, 0.026132, 0.024843, 0.023633, 0.022494, 0.021422,
 0.020414, 0.019463, 0.018567, 0.017722, 0.016924, 0.016171, 0.015459, 0.014785, 0.074225,
 0.069798, 0.065679, 0.061843, 0.058268, 0.054936, 0.051829, 0.048931, 0.046228, 0.043703,
 0.041343, 0.039137, 0.037072, 0.035139, 0.033328, 0.031630, 0.030037, 0.028543, 0.027139,
 0.025819, 0.024578, 0.023410, 0.022309, 0.021273, 0.020295, 0.019372, 0.018501, 0.017678,
 0.016901, 0.016165, 0.015469, 0.075361, 0.070957, 0.066849, 0.063016, 0.059440, 0.056102,
 0.052985, 0.050072, 0.047350, 0.044803, 0.042421, 0.040193, 0.038105, 0.036148, 0.034312,
 0.032589, 0.030971, 0.029451, 0.028022, 0.026677, 0.025411, 0.024219, 0.023095, 0.022035,
 0.021035, 0.020090, 0.019198, 0.018354, 0.017556, 0.016801, 0.016085, 0.076127, 0.071766,
 0.067693, 0.063885, 0.060325, 0.056996, 0.053881, 0.050967, 0.048239, 0.045687, 0.043295,
 0.041054, 0.038952, 0.036981, 0.035131, 0.033391, 0.031757, 0.030219, 0.028772, 0.027409,
 0.026125, 0.024914, 0.023772, 0.022695, 0.021677, 0.020715, 0.019806, 0.018946, 0.018131,
 0.017360, 0.016629, 0.076655, 0.072354, 0.068324, 0.064551, 0.061018, 0.057710, 0.054611,
 0.051707, 0.048986, 0.046434, 0.044040, 0.041794, 0.039685, 0.037704, 0.035843, 0.034092,
 0.032446, 0.030895, 0.029434, 0.028058, 0.026760, 0.025536, 0.024380, 0.023289, 0.022256,
 0.021280, 0.020356, 0.019482, 0.018654, 0.017869, 0.017125, 0.076897, 0.072670, 0.068701,
 0.064976, 0.061484, 0.058208, 0.055135, 0.052251, 0.049545, 0.047004, 0.044618, 0.042376,
 0.040269, 0.038287, 0.036421, 0.034666, 0.033013, 0.031456, 0.029989, 0.028604, 0.027298,
 0.026063, 0.024898, 0.023795, 0.022753, 0.021767, 0.020833, 0.019949, 0.019110, 0.018314,
 0.017560, 0.076945, 0.072797, 0.068895, 0.065228, 0.061785, 0.058549, 0.055507, 0.052649,
 0.049964, 0.047441, 0.045069, 0.042837, 0.040737, 0.038760, 0.036897, 0.035143, 0.033489,
 0.031930, 0.030458, 0.029069, 0.027756, 0.026516, 0.025343, 0.024234, 0.023185, 0.022191,
 0.021249, 0.020357, 0.019510, 0.018707, 0.017944, 0.076829, 0.072769, 0.068942, 0.065342,
 0.061954, 0.058764, 0.055764, 0.052942, 0.050285, 0.047784, 0.045429, 0.043211, 0.041122,
 0.039154, 0.037299, 0.035549, 0.033897, 0.032338, 0.030866, 0.029475, 0.028159, 0.026915,
 0.025739, 0.024625, 0.023570, 0.022570, 0.021622, 0.020723, 0.019870, 0.019060, 0.018292,
 0.076497, 0.072531, 0.068792, 0.065268, 0.061944, 0.058809, 0.055857, 0.053076, 0.050454,
 0.047982, 0.045653, 0.043455, 0.041385, 0.039432, 0.037588, 0.035848, 0.034204, 0.032650,
 0.031182, 0.029794, 0.028480, 0.027238, 0.026060, 0.024946, 0.023889, 0.022887, 0.021936,
 0.021034, 0.020177, 0.019364, 0.018591, 0.076031, 0.072173, 0.068522, 0.065073, 0.061817,
 0.058743, 0.055842, 0.053105, 0.050523, 0.048088, 0.045789, 0.043619, 0.041569, 0.039633,
 0.037804, 0.036075, 0.034443, 0.032899, 0.031438, 0.030056, 0.028747, 0.027507, 0.026332,
 0.025218, 0.024162, 0.023160, 0.022208, 0.021304, 0.020445, 0.019629, 0.018852, 0.075464,
 0.071707, 0.068149, 0.064784, 0.061599, 0.058588, 0.055741, 0.053053, 0.050513, 0.048114,
 0.045846, 0.043703, 0.041678, 0.039763, 0.037954, 0.036243, 0.034623, 0.033090, 0.031638,
 0.030264, 0.028961, 0.027726, 0.026555, 0.025444, 0.024390, 0.023389, 0.022438, 0.021534,
 0.020674, 0.019857, 0.019079, 0.074788, 0.071138, 0.067672, 0.064390, 0.061280, 0.058334,
 0.055547, 0.052910, 0.050415, 0.048054, 0.045822, 0.043710, 0.041713, 0.039823, 0.038035,
 0.036341, 0.034736, 0.033218, 0.031778, 0.030414, 0.029120, 0.027893, 0.026728, 0.025622,
 0.024572, 0.023574, 0.022625, 0.021723, 0.020864, 0.020048, 0.019271, 0.073979, 0.070446,
 0.067080, 0.063886, 0.060858, 0.057984, 0.055257, 0.052672, 0.050225, 0.047908, 0.045716,
 0.043639, 0.041674, 0.039812, 0.038048, 0.036376, 0.034791, 0.033288, 0.031862, 0.030509,
 0.029227, 0.028009, 0.026852, 0.025754, 0.024710, 0.023718, 0.022774, 0.021876, 0.021020,
 0.020206, 0.019430, 0.073119, 0.069693, 0.066425, 0.063322, 0.060372, 0.057569, 0.054909,
 0.052385, 0.049991, 0.047721, 0.045566, 0.043526, 0.041591, 0.039757, 0.038018, 0.036369,
 0.034804, 0.033318, 0.031909, 0.030571, 0.029301, 0.028093, 0.026946, 0.025855, 0.024818,
 0.023832, 0.022893, 0.021999, 0.021148, 0.020337, 0.019563, 0.072159, 0.068844, 0.065682,
 0.062667, 0.059796, 0.057069, 0.054473, 0.052010, 0.049671, 0.047451, 0.045342, 0.043340,
 0.041439, 0.039637, 0.037925, 0.036301, 0.034760, 0.033295, 0.031904, 0.030581, 0.029325,
 0.028131, 0.026995, 0.025915, 0.024887, 0.023909, 0.022977, 0.022089, 0.021243, 0.020436,
 0.019667, 0.071166, 0.067963, 0.064902, 0.061977, 0.059185, 0.056532, 0.054006, 0.051599,
 0.049312, 0.047140, 0.045076, 0.043115, 0.041252, 0.039480, 0.037797, 0.036200, 0.034681,
 0.033238, 0.031865, 0.030559, 0.029317, 0.028135, 0.027013, 0.025944, 0.024925, 0.023956,
 0.023031, 0.022151, 0.021311, 0.020509, 0.019744, 0.070136, 0.067043, 0.064082, 0.061249,
 0.058542, 0.055959, 0.053495, 0.051150, 0.048921, 0.046801, 0.044781, 0.042858, 0.041029,
 0.039289, 0.037636, 0.036065, 0.034571, 0.033151, 0.031799, 0.030512, 0.029287, 0.028121,
 0.027010, 0.025953, 0.024945, 0.023985, 0.023068, 0.022195, 0.021361, 0.020566, 0.019806,
 0.069035, 0.066053, 0.063190, 0.060447, 0.057825, 0.055315, 0.052923, 0.050642, 0.048467,
 0.046395, 0.044421, 0.042540, 0.040753, 0.039052, 0.037431, 0.035887, 0.034418, 0.033020,
 0.031689, 0.030422, 0.029215, 0.028065, 0.026969, 0.025924, 0.024928, 0.023978, 0.023072,
 0.022207, 0.021381, 0.020593, 0.019840, 0.067964, 0.065084, 0.062320, 0.059665, 0.057118,
 0.054685, 0.052359, 0.050136, 0.048013, 0.045993, 0.044064, 0.042226, 0.040473, 0.038804,
 0.037216, 0.035702, 0.034259, 0.032884, 0.031574, 0.030325, 0.029135, 0.028001, 0.026920,
 0.025888, 0.024904, 0.023964, 0.023067, 0.022211, 0.021393, 0.020611, 0.019865, 0.066831,
 0.064060, 0.061383, 0.058818, 0.056351, 0.053989, 0.051730, 0.049565, 0.047500, 0.045529,
 0.043646, 0.041850, 0.040139, 0.038509, 0.036953, 0.035468, 0.034051, 0.032699, 0.031412,
 0.030186, 0.029015, 0.027898, 0.026832, 0.025814, 0.024841, 0.023913, 0.023028, 0.022182,
 0.021374, 0.020602, 0.019863, 0.065689, 0.063018, 0.060432, 0.057947, 0.055557, 0.053268,
 0.051078, 0.048977, 0.046964, 0.045046, 0.043215, 0.041463, 0.039789, 0.038189, 0.036663,
 0.035210, 0.033822, 0.032496, 0.031230, 0.030022, 0.028869, 0.027769, 0.026721, 0.025720,
 0.024763, 0.023848, 0.022974, 0.022138, 0.021338, 0.020574, 0.019842, 0.064487, 0.061913,
 0.059432, 0.057034, 0.054728, 0.052510, 0.050383, 0.048343, 0.046392, 0.044522, 0.042735,
 0.041026, 0.039394, 0.037834, 0.036342, 0.034917, 0.033559, 0.032261, 0.031021, 0.029836,
 0.028704, 0.027621, 0.026589, 0.025603, 0.024660, 0.023758, 0.022896, 0.022072, 0.021283,
 0.020528, 0.019805, 0.063278, 0.060802, 0.058408, 0.056101, 0.053870, 0.051724, 0.049663,
 0.047685, 0.045789, 0.043973, 0.042230, 0.040565, 0.038972, 0.037450, 0.035993, 0.034600,
 0.033269, 0.031998, 0.030784, 0.029622, 0.028511, 0.027449, 0.026433, 0.025462, 0.024533,
 0.023646, 0.022797, 0.021985, 0.021207, 0.020462, 0.019749, 0.062197, 0.059807, 0.057497,
 0.055268, 0.053110, 0.051029, 0.049021, 0.047100, 0.045253, 0.043487, 0.041792, 0.040166,
 0.038608, 0.037117, 0.035689, 0.034324, 0.033019, 0.031773, 0.030579, 0.029437, 0.028347,
 0.027303, 0.026306, 0.025350, 0.024436, 0.023560, 0.022721, 0.021919, 0.021150, 0.020414,
 0.019708, 0.060942, 0.058653, 0.056432, 0.054284, 0.052205, 0.050201, 0.048264, 0.046399,
 0.044603, 0.042882, 0.041231, 0.039646, 0.038131, 0.036681, 0.035290, 0.033960, 0.032687,
 0.031467, 0.030300, 0.029183, 0.028112, 0.027087, 0.026107, 0.025168, 0.024268, 0.023406,
 0.022581, 0.021792, 0.021035, 0.020310, 0.019615, 0.059866, 0.057655, 0.055512, 0.053429,
 0.051418, 0.049469, 0.047590, 0.045783, 0.044043, 0.042368, 0.040764, 0.039225, 0.037746,
 0.036326, 0.034966, 0.033664, 0.032414, 0.031216, 0.030067, 0.028968, 0.027915, 0.026907,
 0.025943, 0.025019, 0.024135, 0.023287, 0.022475, 0.021696, 0.020950, 0.020234, 0.019547,
 0.058674, 0.056562, 0.054503, 0.052502, 0.050558, 0.048676, 0.046860, 0.045106, 0.043419,
 0.041794, 0.040231, 0.038731, 0.037288, 0.035906, 0.034579, 0.033306, 0.032086, 0.030915,
 0.029794, 0.028719, 0.027689, 0.026701, 0.025755, 0.024847, 0.023978, 0.023145, 0.022345,
 0.021579, 0.020844, 0.020139, 0.019463, 0.057491, 0.055450, 0.053465, 0.051528, 0.049650,
 0.047833, 0.046072, 0.044374, 0.042740, 0.041167, 0.039655, 0.038199, 0.036796, 0.035450,
 0.034159, 0.032919, 0.031728, 0.030584, 0.029486, 0.028432, 0.027424, 0.026457, 0.025531,
 0.024641, 0.023787, 0.022967, 0.022182, 0.021429, 0.020706, 0.020013, 0.019347, 0.056300,
 0.054348, 0.052444, 0.050580, 0.048769, 0.047008, 0.045307, 0.043663, 0.042080, 0.040554,
 0.039082, 0.037662, 0.036298, 0.034986, 0.033724, 0.032510, 0.031346, 0.030230, 0.029158,
 0.028132, 0.027146, 0.026200, 0.025291, 0.024420, 0.023585, 0.022783, 0.022012, 0.021271,
 0.020560, 0.019876, 0.019222, 0.055127, 0.053255, 0.051432, 0.049640, 0.047890, 0.046201,
 0.044556, 0.042967, 0.041433, 0.039947, 0.038516, 0.037139, 0.035809, 0.034533, 0.033308,
 0.032128, 0.030992, 0.029901, 0.028853, 0.027848, 0.026883, 0.025957, 0.025066, 0.024210,
 0.023388, 0.022598, 0.021842, 0.021116, 0.020418, 0.019748, 0.019103, 0.054106, 0.052295,
 0.050527, 0.048801, 0.047108, 0.045464, 0.043879, 0.042336, 0.040837, 0.039390, 0.038004,
 0.036664, 0.035369, 0.034120, 0.032918, 0.031763, 0.030655, 0.029592, 0.028568, 0.027583,
 0.026635, 0.025726, 0.024851, 0.024009, 0.023203, 0.022429, 0.021686, 0.020972, 0.020285,
 0.019625, 0.018990, 0.053029, 0.051296, 0.049593, 0.047925, 0.046301, 0.044710, 0.043162,
 0.041666, 0.040218, 0.038815, 0.037460, 0.036155, 0.034897, 0.033681, 0.032507, 0.031386,
 0.030305, 0.029264, 0.028260, 0.027294, 0.026364, 0.025474, 0.024620, 0.023798, 0.023007,
 0.022246, 0.021514, 0.020809, 0.020131, 0.019482, 0.018858, 0.051895, 0.050218, 0.048587,
 0.046990, 0.045419, 0.043878, 0.042390, 0.040952, 0.039555, 0.038197, 0.036879, 0.035608,
 0.034384, 0.033203, 0.032071, 0.030977, 0.029921, 0.028903, 0.027922, 0.026978, 0.026073,
 0.025201, 0.024363, 0.023555, 0.022780, 0.022037, 0.021322, 0.020633, 0.019970, 0.019332,
 0.018717, 0.050723, 0.049130, 0.047555, 0.046014, 0.044499, 0.043025, 0.041590, 0.040194,
 0.038841, 0.037530, 0.036256, 0.035028, 0.033841, 0.032692, 0.031590, 0.030524, 0.029495,
 0.028504, 0.027552, 0.026635, 0.025750, 0.024898, 0.024080, 0.023293, 0.022535, 0.021805,
 0.021102, 0.020424, 0.019775, 0.019150, 0.018548, 0.049747, 0.048207, 0.046699, 0.045203,
 0.043746, 0.042318, 0.040928, 0.039572, 0.038256, 0.036983, 0.035744, 0.034549, 0.033392,
 0.032273, 0.031190, 0.030150, 0.029148, 0.028180, 0.027246, 0.026345, 0.025481, 0.024649,
 0.023847, 0.023073, 0.022328, 0.021611, 0.020922, 0.020259, 0.019620, 0.019003, 0.018410,
 0.048682, 0.047209, 0.045757, 0.044317, 0.042914, 0.041536, 0.040188, 0.038881, 0.037607,
 0.036367, 0.035168, 0.034007, 0.032885, 0.031798, 0.030744, 0.029731, 0.028754, 0.027811,
 0.026901, 0.026022, 0.025174, 0.024358, 0.023574, 0.022818, 0.022089, 0.021388, 0.020712,
 0.020060, 0.019432, 0.018826, 0.018243, 0.047698, 0.046276, 0.044862, 0.043490, 0.042131,
 0.040790, 0.039489, 0.038228, 0.036995, 0.035790, 0.034621, 0.033492, 0.032403, 0.031349,
 0.030326, 0.029335, 0.028376, 0.027455, 0.026565, 0.025707, 0.024884, 0.024089, 0.023321,
 0.022580, 0.021865, 0.021175, 0.020509, 0.019870, 0.019255, 0.018661, 0.018088, 0.046598,
 0.045243, 0.043909, 0.042583, 0.041273, 0.039979, 0.038722, 0.037503, 0.036309, 0.035154,
 0.034030, 0.032935, 0.031876, 0.030846, 0.029847, 0.028884, 0.027954, 0.027058, 0.026192,
 0.025357, 0.024551, 0.023774, 0.023025, 0.022301, 0.021605, 0.020933, 0.020283, 0.019659,
 0.019056, 0.018475, 0.017914, 0.045749, 0.044440, 0.043141, 0.041857, 0.040593, 0.039353,
 0.038136, 0.036950, 0.035789, 0.034661, 0.033563, 0.032496, 0.031465, 0.030462, 0.029492,
 0.028554, 0.027647, 0.026769, 0.025921, 0.025103, 0.024311, 0.023547, 0.022807, 0.022095,
 0.021408, 0.020746, 0.020108, 0.019493, 0.018900, 0.018327, 0.017775, 0.044839, 0.043585,
 0.042338, 0.041098, 0.039877, 0.038670, 0.037491, 0.036333, 0.035204, 0.034105, 0.033034,
 0.031996, 0.030988, 0.030013, 0.029069, 0.028157, 0.027271, 0.026416, 0.025589, 0.024787,
 0.024013, 0.023266, 0.022546, 0.021851, 0.021179, 0.020529, 0.019903, 0.019300, 0.018717,
 0.018155, 0.017613, 0.043758, 0.042548, 0.041358, 0.040168, 0.038995, 0.037838, 0.036705,
 0.035592, 0.034510, 0.033449, 0.032414, 0.031415, 0.030440, 0.029495, 0.028583, 0.027696,
 0.026834, 0.025998, 0.025191, 0.024413, 0.023661, 0.022934, 0.022229, 0.021554, 0.020901,
 0.020270, 0.019659, 0.019069, 0.018498, 0.017947, 0.017417, 0.042816, 0.041650, 0.040497,
 0.039353, 0.038229, 0.037114, 0.036017, 0.034944, 0.033897, 0.032869, 0.031864, 0.030895,
 0.029948, 0.029031, 0.028139, 0.027274, 0.026440, 0.025631, 0.024846, 0.024085, 0.023347,
 0.022636, 0.021951, 0.021288, 0.020646, 0.020027, 0.019430, 0.018853, 0.018295, 0.017756,
 0.017235, 0.042104, 0.040978, 0.039861, 0.038744, 0.037647, 0.036558, 0.035492, 0.034447,
 0.033417, 0.032416, 0.031443, 0.030498, 0.029574, 0.028672, 0.027803, 0.026960, 0.026141,
 0.025344, 0.024571, 0.023828, 0.023110, 0.022414, 0.021739, 0.021085, 0.020455, 0.019846,
 0.019260, 0.018693, 0.018144, 0.017613, 0.017100, 0.041124, 0.040056, 0.038986, 0.037915,
 0.036852, 0.035810, 0.034790, 0.033781, 0.032785, 0.031813, 0.030872, 0.029952, 0.029058,
 0.028191, 0.027344, 0.026520, 0.025718, 0.024944, 0.024195, 0.023471, 0.022771, 0.022093,
 0.021435, 0.020798, 0.020183, 0.019589, 0.019014, 0.018458, 0.017919, 0.017400, 0.016898,
 0.040197, 0.039171, 0.038142, 0.037115, 0.036101, 0.035095, 0.034101, 0.033127, 0.032174,
 0.031236, 0.030324, 0.029430, 0.028562, 0.027715, 0.026895, 0.026097, 0.025321, 0.024569,
 0.023841, 0.023135, 0.022450, 0.021784, 0.021142, 0.020521, 0.019919, 0.019337, 0.018776,
 0.018232, 0.017706, 0.017199, 0.016709, 0.039477, 0.038475, 0.037477, 0.036485, 0.035499,
 0.034523, 0.033561, 0.032617, 0.031687, 0.030776, 0.029883, 0.029012, 0.028165, 0.027339,
 0.026534, 0.025755, 0.024996, 0.024263, 0.023552, 0.022861, 0.022190, 0.021542, 0.020913,
 0.020305, 0.019717, 0.019147, 0.018596, 0.018061, 0.017545, 0.017047, 0.016564, 0.038725,
 0.037760, 0.036792, 0.035828, 0.034877, 0.033932, 0.032997, 0.032079, 0.031176, 0.030287,
 0.029418, 0.028570, 0.027746, 0.026945, 0.026162, 0.025400, 0.024659, 0.023944, 0.023248,
 0.022570, 0.021916, 0.021280, 0.020663, 0.020066, 0.019490, 0.018931, 0.018389, 0.017865,
 0.017360, 0.016870, 0.016396, 0.037721, 0.036812, 0.035887, 0.034970, 0.034052, 0.033149,
 0.032248, 0.031361, 0.030493, 0.029639, 0.028809, 0.027993, 0.027191, 0.026412, 0.025657,
 0.024921, 0.024205, 0.023510, 0.022837, 0.022181, 0.021543, 0.020923, 0.020325, 0.019745,
 0.019183, 0.018641, 0.018115, 0.017604, 0.017109, 0.016631, 0.016170, 0.036987, 0.036106,
 0.035217, 0.034327, 0.033443, 0.032561, 0.031684, 0.030824, 0.029979, 0.029150, 0.028335,
 0.027542, 0.026763, 0.026007, 0.025270, 0.024551, 0.023854, 0.023173, 0.022514, 0.021874,
 0.021252, 0.020648, 0.020065, 0.019498, 0.018948, 0.018415, 0.017898, 0.017400, 0.016916,
 0.016447, 0.015993, 0.036248, 0.035401, 0.034549, 0.033686, 0.032827, 0.031978, 0.031140,
 0.030310, 0.029486, 0.028683, 0.027892, 0.027122, 0.026367, 0.025635, 0.024917, 0.024215,
 0.023532, 0.022870, 0.022224, 0.021596, 0.020990, 0.020400, 0.019826, 0.019272, 0.018736,
 0.018215, 0.017709, 0.017218, 0.016742, 0.016281, 0.015837, 0.035454, 0.034631, 0.033808,
 0.032984, 0.032158, 0.031337, 0.030528, 0.029724, 0.028934, 0.028157, 0.027388, 0.026639,
 0.025905, 0.025193, 0.024496, 0.023813, 0.023149, 0.022507, 0.021879, 0.021268, 0.020677,
 0.020104, 0.019546, 0.019003, 0.018475, 0.017965, 0.017472, 0.016993, 0.016528, 0.016077,
 0.015640, 0.034978, 0.034182, 0.033379, 0.032572, 0.031761, 0.030962, 0.030160, 0.029376,
 0.028596, 0.027836, 0.027088, 0.026349, 0.025633, 0.024931, 0.024241, 0.023575, 0.022924,
 0.022288, 0.021669, 0.021071, 0.020489, 0.019921, 0.019369, 0.018837, 0.018322, 0.017821,
 0.017333, 0.016860, 0.016400, 0.015956, 0.015528, 0.034157, 0.033400, 0.032632, 0.031857,
 0.031079, 0.030304, 0.029537, 0.028778, 0.028023, 0.027287, 0.026561, 0.025851, 0.025160,
 0.024479, 0.023810, 0.023166, 0.022535, 0.021918, 0.021315, 0.020735, 0.020171, 0.019620,
 0.019083, 0.018561, 0.018056, 0.017568, 0.017093, 0.016631, 0.016182, 0.015746, 0.015326,
 0.033320, 0.032597, 0.031855, 0.031109, 0.030359, 0.029625, 0.028886, 0.028150, 0.027428,
 0.026713, 0.026015, 0.025331, 0.024656, 0.023993, 0.023353, 0.022725, 0.022110, 0.021511,
 0.020932, 0.020367, 0.019816, 0.019278, 0.018754, 0.018252, 0.017763, 0.017288, 0.016825,
 0.016375, 0.015937, 0.015511, 0.015102, 0.032838, 0.032126, 0.031403, 0.030684, 0.029956,
 0.029228, 0.028510, 0.027792, 0.027081, 0.026389, 0.025701, 0.025030, 0.024375, 0.023730,
 0.023095, 0.022473, 0.021875, 0.021289, 0.020717, 0.020159, 0.019614, 0.019091, 0.018582,
 0.018085, 0.017601, 0.017130, 0.016671, 0.016229, 0.015802, 0.015388, 0.014984, 0.032059,
 0.031380, 0.030683, 0.029997, 0.029298, 0.028594, 0.027902, 0.027212, 0.026524, 0.025859,
 0.025200, 0.024547, 0.023901, 0.023280, 0.022673, 0.022076, 0.021490, 0.020916, 0.020364,
 0.019825, 0.019300, 0.018787, 0.018286, 0.017798, 0.017327, 0.016871, 0.016429, 0.015999,
 0.015581, 0.015174, 0.014778, 0.031476, 0.030820, 0.030141, 0.029478, 0.028800, 0.028112,
 0.027445, 0.026778, 0.026111, 0.025450, 0.024815, 0.024185, 0.023561, 0.022945, 0.022344,
 0.021765, 0.021197, 0.020639, 0.020093, 0.019558, 0.019044, 0.018545, 0.018060, 0.017588,
 0.017126, 0.016677, 0.016238, 0.015812, 0.015400, 0.015000, 0.014614, 0.030990, 0.030347,
 0.029697, 0.029048, 0.028387, 0.027718, 0.027064, 0.026412, 0.025761, 0.025116, 0.024490,
 0.023874, 0.023267, 0.022668, 0.022079, 0.021503, 0.020950, 0.020408, 0.019878, 0.019360,
 0.018854, 0.018359, 0.017879, 0.017410, 0.016957, 0.016518, 0.016090, 0.015675, 0.015271,
 0.014878, 0.014497, 0.030108, 0.029483, 0.028874, 0.028250, 0.027613, 0.026971, 0.026353,
 0.025733, 0.025111, 0.024490, 0.023878, 0.023285, 0.022707, 0.022137, 0.021575, 0.021023,
 0.020479, 0.019945, 0.019428, 0.018928, 0.018444, 0.017970, 0.017508, 0.017058, 0.016618,
 0.016190, 0.015772, 0.015364, 0.014967, 0.014585, 0.014215, 0.029609, 0.029023, 0.028438,
 0.027832, 0.027211, 0.026580, 0.025965, 0.025365, 0.024767, 0.024170, 0.023574, 0.022982,
 0.022400, 0.021839, 0.021293, 0.020754, 0.020232, 0.019720, 0.019217, 0.018724, 0.018241,
 0.017768, 0.017308, 0.016864, 0.016432, 0.016013, 0.015607, 0.015211, 0.014826, 0.014452,
 0.014088, 0.029026, 0.028468, 0.027903, 0.027320, 0.026722, 0.026113, 0.025496, 0.024905,
 0.024327, 0.023749, 0.023181, 0.022621, 0.022066, 0.021517, 0.020974, 0.020439, 0.019913,
 0.019406, 0.018916, 0.018437, 0.017972, 0.017520, 0.017077, 0.016644, 0.016223, 0.015813,
 0.015416, 0.015029, 0.014652, 0.014284, 0.013926, 0.028454, 0.027916, 0.027365, 0.026805,
 0.026237, 0.025661, 0.025080, 0.024495, 0.023906, 0.023323, 0.022760, 0.022213, 0.021674,
 0.021145, 0.020625, 0.020117, 0.019615, 0.019127, 0.018651, 0.018184, 0.017727, 0.017285,
 0.016852, 0.016429, 0.016015, 0.015613, 0.015221, 0.014839, 0.014467, 0.014103, 0.013749,
 0.027845, 0.027321, 0.026784, 0.026238, 0.025688, 0.025135, 0.024580, 0.024028, 0.023477,
 0.022930, 0.022393, 0.021859, 0.021336, 0.020820, 0.020311, 0.019815, 0.019327, 0.018848,
 0.018382, 0.017927, 0.017481, 0.017044, 0.016620, 0.016206, 0.015804, 0.015410, 0.015027,
 0.014655, 0.014291, 0.013936, 0.013590, 0.027430, 0.026915, 0.026387, 0.025849, 0.025305,
 0.024760, 0.024213, 0.023668, 0.023126, 0.022587, 0.022058, 0.021533, 0.021016, 0.020509,
 0.020009, 0.019521, 0.019042, 0.018571, 0.018114, 0.017666, 0.017227, 0.016800, 0.016384,
 0.015978, 0.015582, 0.015195, 0.014820, 0.014455, 0.014099, 0.013753, 0.013414, 0.026810,
 0.026305, 0.025788, 0.025262, 0.024759, 0.024245, 0.023724, 0.023205, 0.022683, 0.022166,
 0.021653, 0.021147, 0.020647, 0.020156, 0.019672, 0.019198, 0.018735, 0.018280, 0.017832,
 0.017392, 0.016965, 0.016548, 0.016140, 0.015741, 0.015354, 0.014978, 0.014610, 0.014252,
 0.013902, 0.013563, 0.013233, 0.026308, 0.025817, 0.025315, 0.024833, 0.024339, 0.023835,
 0.023325, 0.022815, 0.022299, 0.021791, 0.021286, 0.020787, 0.020297, 0.019811, 0.019338,
 0.018883, 0.018436, 0.017998, 0.017566, 0.017142, 0.016727, 0.016319, 0.015924, 0.015537,
 0.015158, 0.014788, 0.014428, 0.014076, 0.013734, 0.013401, 0.013078, 0.025734, 0.025277,
 0.024811, 0.024327, 0.023838, 0.023339, 0.022839, 0.022346, 0.021862, 0.021379, 0.020894,
 0.020414, 0.019942, 0.019472, 0.019010, 0.018560, 0.018114, 0.017683, 0.017265, 0.016854,
 0.016450, 0.016055, 0.015667, 0.015289, 0.014922, 0.014562, 0.014211, 0.013867, 0.013533,
 0.013207, 0.012892, 0.025528, 0.025076, 0.024599, 0.024124, 0.023651, 0.023170, 0.022679,
 0.022183, 0.021695, 0.021216, 0.020745, 0.020274, 0.019807, 0.019342, 0.018886, 0.018436,
 0.018004, 0.017580, 0.017165, 0.016758, 0.016358, 0.015965, 0.015579, 0.015204, 0.014836,
 0.014479, 0.014130, 0.013789, 0.013463, 0.013144, 0.012833, 0.024940, 0.024510, 0.024054,
 0.023596, 0.023137, 0.022666, 0.022191, 0.021722, 0.021258, 0.020795, 0.020329, 0.019864,
 0.019408, 0.018968, 0.018533, 0.018104, 0.017679, 0.017259, 0.016851, 0.016449, 0.016059,
 0.015681, 0.015311, 0.014948, 0.014592, 0.014244, 0.013905, 0.013575, 0.013252, 0.012937,
 0.012630, 0.024449, 0.024020, 0.023597, 0.023154, 0.022695, 0.022248, 0.021794, 0.021331,
 0.020873, 0.020427, 0.019978, 0.019529, 0.019086, 0.018651, 0.018229, 0.017810, 0.017396,
 0.016986, 0.016590, 0.016200, 0.015822, 0.015452, 0.015089, 0.014732, 0.014382, 0.014042,
 0.013713, 0.013390, 0.013074, 0.012769, 0.012472, 0.024126, 0.023725, 0.023301, 0.022865,
 0.022429, 0.021979, 0.021528, 0.021083, 0.020633, 0.020193, 0.019752, 0.019314, 0.018878,
 0.018448, 0.018035, 0.017624, 0.017217, 0.016815, 0.016420, 0.016040, 0.015668, 0.015302,
 0.014943, 0.014591, 0.014248, 0.013917, 0.013593, 0.013275, 0.012964, 0.012660, 0.012365,
 0.023570, 0.023176, 0.022769, 0.022352, 0.021930, 0.021499, 0.021068, 0.020635, 0.020203,
 0.019777, 0.019350, 0.018926, 0.018509, 0.018095, 0.017686, 0.017286, 0.016893, 0.016506,
 0.016127, 0.015753, 0.015390, 0.015035, 0.014686, 0.014345, 0.014011, 0.013684, 0.013367,
 0.013059, 0.012757, 0.012461, 0.012173, 0.023283, 0.022895, 0.022497, 0.022086, 0.021674,
 0.021250, 0.020830, 0.020405, 0.019981, 0.019561, 0.019139, 0.018724, 0.018314, 0.017907,
 0.017501, 0.017107, 0.016720, 0.016339, 0.015963, 0.015597, 0.015241, 0.014890, 0.014546,
 0.014208, 0.013880, 0.013561, 0.013249, 0.012943, 0.012643, 0.012352, 0.012068, 0.022716,
 0.022351, 0.021969, 0.021580, 0.021181, 0.020771, 0.020363, 0.019950, 0.019543, 0.019136,
 0.018733, 0.018331, 0.017933, 0.017543, 0.017157, 0.016774, 0.016393, 0.016024, 0.015662,
 0.015305, 0.014959, 0.014618, 0.014283, 0.013956, 0.013638, 0.013327, 0.013022, 0.012724,
 0.012433, 0.012149, 0.011871, 0.022415, 0.022061, 0.021684, 0.021300, 0.020904, 0.020507,
 0.020109, 0.019707, 0.019303, 0.018905, 0.018510, 0.018117, 0.017724, 0.017338, 0.016958,
 0.016581, 0.016210, 0.015848, 0.015490, 0.015140, 0.014801, 0.014466, 0.014136, 0.013812,
 0.013500, 0.013194, 0.012893, 0.012599, 0.012312, 0.012035, 0.011764, 0.021944, 0.021596,
 0.021234, 0.020867, 0.020490, 0.020105, 0.019720, 0.019330, 0.018943, 0.018553, 0.018170,
 0.017784, 0.017408, 0.017032, 0.016660, 0.016297, 0.015937, 0.015583, 0.015238, 0.014897,
 0.014560, 0.014236, 0.013916, 0.013601, 0.013293, 0.012995, 0.012703, 0.012416, 0.012135,
 0.011861, 0.011596, 0.021654, 0.021314, 0.020955, 0.020588, 0.020227, 0.019852, 0.019466,
 0.019093, 0.018713, 0.018329, 0.017949, 0.017571, 0.017197, 0.016833, 0.016473, 0.016114,
 0.015758, 0.015408, 0.015066, 0.014730, 0.014403, 0.014081, 0.013768, 0.013462, 0.013162,
 0.012866, 0.012576, 0.012291, 0.012016, 0.011748, 0.011485, 0.021086, 0.020752, 0.020414,
 0.020068, 0.019716, 0.019355, 0.018992, 0.018626, 0.018256, 0.017888, 0.017525, 0.017164,
 0.016807, 0.016453, 0.016101, 0.015755, 0.015415, 0.015080, 0.014749, 0.014422, 0.014106,
 0.013794, 0.013487, 0.013188, 0.012898, 0.012613, 0.012333, 0.012058, 0.011793, 0.011533,
 0.011277, 0.020826, 0.020508, 0.020178, 0.019835, 0.019483, 0.019129, 0.018770, 0.018410,
 0.018048, 0.017695, 0.017338, 0.016985, 0.016633, 0.016282, 0.015938, 0.015594, 0.015258,
 0.014927, 0.014602, 0.014282, 0.013969, 0.013663, 0.013362, 0.013066, 0.012779, 0.012497,
 0.012219, 0.011948, 0.011686, 0.011429, 0.011179, 0.020584, 0.020271, 0.019950, 0.019613,
 0.019273, 0.018931, 0.018577, 0.018224, 0.017872, 0.017517, 0.017164, 0.016815, 0.016467,
 0.016123, 0.015780, 0.015446, 0.015118, 0.014795, 0.014474, 0.014158, 0.013851, 0.013549,
 0.013253, 0.012962, 0.012677, 0.012399, 0.012127, 0.011862, 0.011602, 0.011350, 0.011101,
 0.020046, 0.019743, 0.019433, 0.019115, 0.018786, 0.018449, 0.018115, 0.017774, 0.017434,
 0.017091, 0.016754, 0.016416, 0.016082, 0.015750, 0.015418, 0.015095, 0.014776, 0.014465,
 0.014158, 0.013854, 0.013553, 0.013258, 0.012971, 0.012689, 0.012414, 0.012146, 0.011881,
 0.011622, 0.011370, 0.011123, 0.010882, 0.019734, 0.019446, 0.019134, 0.018819, 0.018502,
 0.018178, 0.017847, 0.017515, 0.017183, 0.016849, 0.016518, 0.016188, 0.015865, 0.015540,
 0.015218, 0.014900, 0.014588, 0.014281, 0.013979, 0.013680, 0.013388, 0.013101, 0.012821,
 0.012545, 0.012274, 0.012006, 0.011745, 0.011490, 0.011239, 0.010997, 0.010760, 0.019484,
 0.019202, 0.018909, 0.018598, 0.018283, 0.017967, 0.017644, 0.017321, 0.016994, 0.016668,
 0.016341, 0.016013, 0.015690, 0.015370, 0.015055, 0.014745, 0.014437, 0.014135, 0.013837,
 0.013543, 0.013255, 0.012971, 0.012695, 0.012423, 0.012154, 0.011892, 0.011636, 0.011386,
 0.011140, 0.010900, 0.010666, 0.019190, 0.018917, 0.018627, 0.018332, 0.018025, 0.017714,
 0.017403, 0.017087, 0.016768, 0.016448, 0.016131, 0.015813, 0.015497, 0.015183, 0.014874,
 0.014570, 0.014267, 0.013969, 0.013676, 0.013388, 0.013106, 0.012829, 0.012555, 0.012287,
 0.012025, 0.011768, 0.011517, 0.011271, 0.011032, 0.010796, 0.010565, 0.018669, 0.018406,
 0.018131, 0.017845, 0.017552, 0.017253, 0.016951, 0.016643, 0.016337, 0.016028, 0.015719,
 0.015414, 0.015110, 0.014807, 0.014510, 0.014214, 0.013922, 0.013634, 0.013350, 0.013073,
 0.012801, 0.012531, 0.012266, 0.012009, 0.011756, 0.011507, 0.011262, 0.011024, 0.010792,
 0.010564, 0.010340, 0.018382, 0.018123, 0.017857, 0.017578, 0.017291, 0.017002, 0.016702,
 0.016406, 0.016107, 0.015802, 0.015501, 0.015205, 0.014906, 0.014608, 0.014316, 0.014029,
 0.013743, 0.013459, 0.013181, 0.012909, 0.012643, 0.012379, 0.012119, 0.011864, 0.011614,
 0.011371, 0.011133, 0.010899, 0.010670, 0.010444, 0.010224, 0.018127, 0.017877, 0.017617,
 0.017345, 0.017062, 0.016780, 0.016492, 0.016202, 0.015907, 0.015606, 0.015313, 0.015021,
 0.014730, 0.014442, 0.014157, 0.013871, 0.013587, 0.013311, 0.013041, 0.012775, 0.012511,
 0.012251, 0.011998, 0.011748, 0.011502, 0.011259, 0.011025, 0.010794, 0.010568, 0.010349,
 0.010134, 0.017841, 0.017587, 0.017324, 0.017060, 0.016790, 0.016514, 0.016235, 0.015952,
 0.015667, 0.015380, 0.015094, 0.014807, 0.014521, 0.014239, 0.013957, 0.013679, 0.013402,
 0.013125, 0.012853, 0.012591, 0.012331, 0.012078, 0.011828, 0.011583, 0.011343, 0.011108,
 0.010877, 0.010651, 0.010430, 0.010214, 0.010002, 0.017543, 0.017304, 0.017052, 0.016790,
 0.016527, 0.016261, 0.015988, 0.015712, 0.015429, 0.015149, 0.014864, 0.014584, 0.014302,
 0.014023, 0.013748, 0.013473, 0.013204, 0.012937, 0.012674, 0.012419, 0.012168, 0.011920,
 0.011677, 0.011437, 0.011202, 0.010973, 0.010746, 0.010526, 0.010309, 0.010095, 0.009888,
 0.017304, 0.017071, 0.016826, 0.016572, 0.016317, 0.016050, 0.015780, 0.015510, 0.015235,
 0.014957, 0.014679, 0.014402, 0.014126, 0.013856, 0.013588, 0.013321, 0.013057, 0.012794,
 0.012537, 0.012283, 0.012033, 0.011791, 0.011551, 0.011315, 0.011083, 0.010856, 0.010633,
 0.010414, 0.010200, 0.009990, 0.009784, 0.017025, 0.016800, 0.016565, 0.016317, 0.016060,
 0.015801, 0.015542, 0.015275, 0.015005, 0.014735, 0.014464, 0.014195, 0.013930, 0.013665,
 0.013399, 0.013138, 0.012880, 0.012625, 0.012374, 0.012125, 0.011880, 0.011643, 0.011409,
 0.011177, 0.010948, 0.010726, 0.010508, 0.010292, 0.010081, 0.009877, 0.009677, 0.016786,
 0.016568, 0.016333, 0.016093, 0.015849, 0.015592, 0.015337, 0.015074, 0.014803, 0.014543,
 0.014282, 0.014017, 0.013750, 0.013490, 0.013230, 0.012971, 0.012714, 0.012465, 0.012220,
 0.011979, 0.011739, 0.011502, 0.011269, 0.011042, 0.010820, 0.010600, 0.010384, 0.010171,
 0.009963, 0.009760, 0.009563, 0.016501, 0.016291, 0.016060, 0.015825, 0.015582, 0.015337,
 0.015088, 0.014833, 0.014579, 0.014322, 0.014064, 0.013808, 0.013551, 0.013292, 0.013037,
 0.012787, 0.012536, 0.012292, 0.012049, 0.011813, 0.011578, 0.011348, 0.011122, 0.010899,
 0.010679, 0.010466, 0.010256, 0.010048, 0.009846, 0.009649, 0.009454, 0.016229, 0.016016,
 0.015802, 0.015578, 0.015341, 0.015099, 0.014850, 0.014598, 0.014345, 0.014094, 0.013847,
 0.013597, 0.013343, 0.013095, 0.012844, 0.012596, 0.012354, 0.012111, 0.011874, 0.011643,
 0.011416, 0.011191, 0.010967, 0.010747, 0.010533, 0.010322, 0.010115, 0.009910, 0.009712,
 0.009517, 0.009325, 0.015993, 0.015791, 0.015575, 0.015355, 0.015122, 0.014888, 0.014648,
 0.014403, 0.014157, 0.013909, 0.013664, 0.013418, 0.013170, 0.012928, 0.012685, 0.012444,
 0.012206, 0.011969, 0.011738, 0.011510, 0.011283, 0.011059, 0.010843, 0.010629, 0.010418,
 0.010209, 0.010006, 0.009807, 0.009610, 0.009417, 0.009231, 0.015744, 0.015543, 0.015339,
 0.015125, 0.014903, 0.014669, 0.014434, 0.014196, 0.013961, 0.013718, 0.013477, 0.013236,
 0.012991, 0.012747, 0.012509, 0.012273, 0.012040, 0.011812, 0.011584, 0.011356, 0.011135,
 0.010919, 0.010703, 0.010490, 0.010280, 0.010077, 0.009879, 0.009684, 0.009491, 0.009302,
 0.009118, 0.015477, 0.015283, 0.015087, 0.014873, 0.014654, 0.014428, 0.014201, 0.013967,
 0.013736, 0.013501, 0.013261, 0.013031, 0.012799, 0.012565, 0.012329, 0.012095, 0.011867,
 0.011641, 0.011416, 0.011196, 0.010982, 0.010769, 0.010559, 0.010351, 0.010145, 0.009947,
 0.009753, 0.009563, 0.009376, 0.009191, 0.009009, 0.015243, 0.015054, 0.014852, 0.014651,
 0.014434, 0.014212, 0.013994, 0.013766, 0.013531, 0.013301, 0.013075, 0.012843, 0.012609,
 0.012376, 0.012149, 0.011927, 0.011703, 0.011480, 0.011257, 0.011039, 0.010830, 0.010622,
 0.010418, 0.010216, 0.010017, 0.009821, 0.009626, 0.009434, 0.009251, 0.009071, 0.008894,
 0.014981, 0.014786, 0.014597, 0.014402, 0.014194, 0.013974, 0.013744, 0.013523, 0.013307,
 0.013085, 0.012859, 0.012629, 0.012396, 0.012166, 0.011945, 0.011727, 0.011511, 0.011297,
 0.011085, 0.010875, 0.010666, 0.010458, 0.010252, 0.010055, 0.009861, 0.009670, 0.009483,
 0.009300, 0.009120, 0.008943, 0.008771, 0.014666, 0.014477, 0.014297, 0.014106, 0.013911,
 0.013706, 0.013499, 0.013284, 0.013069, 0.012851, 0.012632, 0.012409, 0.012182, 0.011954,
 0.011735, 0.011521, 0.011310, 0.011099, 0.010893, 0.010689, 0.010486, 0.010287, 0.010092,
 0.009899, 0.009709, 0.009522, 0.009340, 0.009160, 0.008984, 0.008809, 0.008639, 0.014448,
 0.014280, 0.014100, 0.013910, 0.013713, 0.013510, 0.013301, 0.013091, 0.012877, 0.012661,
 0.012445, 0.012228, 0.012013, 0.011798, 0.011585, 0.011373, 0.011163, 0.010956, 0.010751,
 0.010549, 0.010350, 0.010153, 0.009959, 0.009769, 0.009582, 0.009398, 0.009217, 0.009040,
 0.008866, 0.008696, 0.008528 };

static double pmatrix_h[NPRESSURES][NTEMPS] = {
 0.032079, 0.030011, 0.028103, 0.026341, 0.024712, 0.023204, 0.021808, 0.020514, 0.019313,
 0.018197, 0.017160, 0.016195, 0.015297, 0.014459, 0.013678, 0.012949, 0.012267, 0.011630,
 0.011033, 0.010474, 0.009950, 0.009458, 0.008997, 0.008563, 0.008155, 0.007771, 0.007409,
 0.007068, 0.006747, 0.006444, 0.006157, 0.033018, 0.030929, 0.028998, 0.027210, 0.025556,
 0.024024, 0.022603, 0.021283, 0.020057, 0.018917, 0.017856, 0.016867, 0.015945, 0.015085,
 0.014282, 0.013531, 0.012828, 0.012171, 0.011554, 0.010977, 0.010434, 0.009925, 0.009447,
 0.008997, 0.008573, 0.008175, 0.007799, 0.007444, 0.007110, 0.006794, 0.006495, 0.033768,
 0.031670, 0.029727, 0.027927, 0.026257, 0.024707, 0.023268, 0.021931, 0.020687, 0.019529,
 0.018449, 0.017443, 0.016503, 0.015626, 0.014805, 0.014037, 0.013319, 0.012645, 0.012014,
 0.011421, 0.010864, 0.010341, 0.009848, 0.009385, 0.008948, 0.008537, 0.008149, 0.007783,
 0.007437, 0.007110, 0.006801, 0.034349, 0.032254, 0.030310, 0.028506, 0.026830, 0.025273,
 0.023823, 0.022475, 0.021219, 0.020048, 0.018957, 0.017937, 0.016984, 0.016094, 0.015260,
 0.014479, 0.013748, 0.013062, 0.012417, 0.011813, 0.011244, 0.010709, 0.010205, 0.009731,
 0.009284, 0.008862, 0.008464, 0.008087, 0.007732, 0.007396, 0.007078, 0.034765, 0.032682,
 0.030746, 0.028946, 0.027271, 0.025713, 0.024262, 0.022910, 0.021649, 0.020472, 0.019372,
 0.018345, 0.017384, 0.016485, 0.015642, 0.014853, 0.014112, 0.013416, 0.012763, 0.012148,
 0.011571, 0.011027, 0.010514, 0.010031, 0.009576, 0.009145, 0.008739, 0.008355, 0.007992,
 0.007648, 0.007323, 0.035071, 0.033006, 0.031084, 0.029295, 0.027629, 0.026075, 0.024627,
 0.023275, 0.022012, 0.020833, 0.019730, 0.018698, 0.017731, 0.016826, 0.015977, 0.015181,
 0.014433, 0.013730, 0.013070, 0.012449, 0.011864, 0.011313, 0.010793, 0.010303, 0.009840,
 0.009403, 0.008990, 0.008599, 0.008229, 0.007879, 0.007547, 0.035245, 0.033206, 0.031307,
 0.029534, 0.027881, 0.026338, 0.024897, 0.023551, 0.022293, 0.021115, 0.020013, 0.018980,
 0.018012, 0.017104, 0.016253, 0.015453, 0.014701, 0.013994, 0.013329, 0.012703, 0.012113,
 0.011556, 0.011031, 0.010536, 0.010068, 0.009626, 0.009207, 0.008812, 0.008437, 0.008081,
 0.007745, 0.035327, 0.033319, 0.031445, 0.029694, 0.028057, 0.026528, 0.025098, 0.023761,
 0.022510, 0.021337, 0.020238, 0.019208, 0.018242, 0.017335, 0.016483, 0.015682, 0.014928,
 0.014218, 0.013550, 0.012921, 0.012327, 0.011767, 0.011238, 0.010740, 0.010268, 0.009821,
 0.009399, 0.008999, 0.008620, 0.008261, 0.007920, 0.035334, 0.033362, 0.031516, 0.029790,
 0.028176, 0.026665, 0.025249, 0.023923, 0.022681, 0.021516, 0.020423, 0.019398, 0.018435,
 0.017529, 0.016678, 0.015877, 0.015123, 0.014413, 0.013743, 0.013112, 0.012517, 0.011955,
 0.011423, 0.010921, 0.010446, 0.009996, 0.009571, 0.009168, 0.008785, 0.008423, 0.008079,
 0.035240, 0.033308, 0.031497, 0.029800, 0.028211, 0.026721, 0.025324, 0.024014, 0.022784,
 0.021630, 0.020547, 0.019529, 0.018572, 0.017671, 0.016824, 0.016026, 0.015274, 0.014566,
 0.013897, 0.013266, 0.012671, 0.012108, 0.011576, 0.011072, 0.010596, 0.010145, 0.009717,
 0.009312, 0.008928, 0.008563, 0.008217, 0.035084, 0.033193, 0.031419, 0.029754, 0.028191,
 0.026725, 0.025349, 0.024058, 0.022844, 0.021704, 0.020631, 0.019622, 0.018673, 0.017779,
 0.016937, 0.016144, 0.015396, 0.014690, 0.014024, 0.013395, 0.012800, 0.012238, 0.011706,
 0.011202, 0.010725, 0.010273, 0.009845, 0.009438, 0.009053, 0.008686, 0.008339, 0.034877,
 0.033030, 0.031294, 0.029662, 0.028129, 0.026689, 0.025335, 0.024062, 0.022865, 0.021739,
 0.020679, 0.019681, 0.018742, 0.017857, 0.017021, 0.016234, 0.015490, 0.014788, 0.014125,
 0.013499, 0.012906, 0.012345, 0.011814, 0.011311, 0.010834, 0.010382, 0.009954, 0.009547,
 0.009160, 0.008793, 0.008445, 0.034617, 0.032815, 0.031119, 0.029521, 0.028020, 0.026607,
 0.025276, 0.024024, 0.022845, 0.021735, 0.020690, 0.019705, 0.018776, 0.017899, 0.017073,
 0.016292, 0.015555, 0.014858, 0.014200, 0.013577, 0.012987, 0.012429, 0.011900, 0.011398,
 0.010923, 0.010471, 0.010044, 0.009637, 0.009251, 0.008884, 0.008534, 0.034298, 0.032544,
 0.030891, 0.029333, 0.027863, 0.026477, 0.025172, 0.023943, 0.022785, 0.021693, 0.020664,
 0.019694, 0.018778, 0.017912, 0.017095, 0.016322, 0.015592, 0.014902, 0.014249, 0.013630,
 0.013045, 0.012491, 0.011965, 0.011466, 0.010993, 0.010544, 0.010117, 0.009712, 0.009326,
 0.008960, 0.008611, 0.033948, 0.032243, 0.030632, 0.029111, 0.027677, 0.026323, 0.025046,
 0.023841, 0.022703, 0.021630, 0.020617, 0.019661, 0.018758, 0.017904, 0.017097, 0.016333,
 0.015612, 0.014929, 0.014282, 0.013669, 0.013088, 0.012537, 0.012015, 0.011519, 0.011049,
 0.010602, 0.010177, 0.009773, 0.009389, 0.009023, 0.008675, 0.033554, 0.031895, 0.030327,
 0.028847, 0.027446, 0.026125, 0.024877, 0.023698, 0.022584, 0.021531, 0.020536, 0.019596,
 0.018706, 0.017866, 0.017071, 0.016318, 0.015605, 0.014930, 0.014290, 0.013684, 0.013109,
 0.012564, 0.012046, 0.011554, 0.011087, 0.010643, 0.010221, 0.009819, 0.009437, 0.009073,
 0.008727, 0.033141, 0.031532, 0.030005, 0.028565, 0.027201, 0.025910, 0.024689, 0.023535,
 0.022444, 0.021413, 0.020437, 0.019513, 0.018639, 0.017812, 0.017028, 0.016286, 0.015583,
 0.014916, 0.014283, 0.013684, 0.013115, 0.012576, 0.012063, 0.011575, 0.011112, 0.010671,
 0.010252, 0.009853, 0.009473, 0.009111, 0.008766, 0.032709, 0.031148, 0.029668, 0.028264,
 0.026934, 0.025675, 0.024485, 0.023358, 0.022290, 0.021279, 0.020320, 0.019413, 0.018554,
 0.017741, 0.016970, 0.016240, 0.015547, 0.014890, 0.014266, 0.013674, 0.013112, 0.012578,
 0.012070, 0.011587, 0.011128, 0.010691, 0.010275, 0.009879, 0.009502, 0.009142, 0.008799,
 0.032240, 0.030728, 0.029293, 0.027929, 0.026636, 0.025411, 0.024249, 0.023149, 0.022104,
 0.021115, 0.020178, 0.019290, 0.018448, 0.017649, 0.016891, 0.016172, 0.015490, 0.014843,
 0.014228, 0.013644, 0.013089, 0.012562, 0.012060, 0.011583, 0.011128, 0.010695, 0.010283,
 0.009891, 0.009517, 0.009160, 0.008820, 0.031784, 0.030319, 0.028924, 0.027601, 0.026344,
 0.025149, 0.024015, 0.022941, 0.021921, 0.020953, 0.020034, 0.019163, 0.018338, 0.017554,
 0.016809, 0.016102, 0.015431, 0.014793, 0.014187, 0.013611, 0.013063, 0.012542, 0.012046,
 0.011574, 0.011124, 0.010696, 0.010287, 0.009898, 0.009528, 0.009174, 0.008836, 0.031294,
 0.029877, 0.028526, 0.027240, 0.026018, 0.024855, 0.023751, 0.022703, 0.021706, 0.020761,
 0.019864, 0.019012, 0.018203, 0.017434, 0.016703, 0.016008, 0.015349, 0.014722, 0.014126,
 0.013558, 0.013018, 0.012504, 0.012014, 0.011547, 0.011104, 0.010681, 0.010277, 0.009893,
 0.009525, 0.009175, 0.008840, 0.030798, 0.029423, 0.028114, 0.026866, 0.025681, 0.024552,
 0.023475, 0.022455, 0.021485, 0.020563, 0.019685, 0.018849, 0.018056, 0.017303, 0.016587,
 0.015905, 0.015256, 0.014638, 0.014052, 0.013493, 0.012962, 0.012456, 0.011974, 0.011514,
 0.011076, 0.010658, 0.010259, 0.009878, 0.009514, 0.009167, 0.008836, 0.030275, 0.028950,
 0.027684, 0.026476, 0.025324, 0.024226, 0.023182, 0.022187, 0.021241, 0.020341, 0.019484,
 0.018670, 0.017894, 0.017156, 0.016455, 0.015787, 0.015151, 0.014545, 0.013968, 0.013419,
 0.012896, 0.012398, 0.011923, 0.011469, 0.011037, 0.010625, 0.010231, 0.009855, 0.009495,
 0.009152, 0.008824, 0.029743, 0.028466, 0.027241, 0.026070, 0.024954, 0.023889, 0.022874,
 0.021907, 0.020985, 0.020107, 0.019271, 0.018475, 0.017717, 0.016996, 0.016309, 0.015655,
 0.015032, 0.014438, 0.013872, 0.013332, 0.012818, 0.012327, 0.011859, 0.011413, 0.010988,
 0.010581, 0.010193, 0.009822, 0.009467, 0.009128, 0.008804, 0.029268, 0.028033, 0.026848,
 0.025712, 0.024625, 0.023589, 0.022600, 0.021659, 0.020761, 0.019904, 0.019086, 0.018307,
 0.017564, 0.016856, 0.016183, 0.015541, 0.014929, 0.014345, 0.013790, 0.013260, 0.012754,
 0.012272, 0.011811, 0.011370, 0.010950, 0.010548, 0.010164, 0.009797, 0.009447, 0.009111,
 0.008791, 0.028715, 0.027525, 0.026380, 0.025287, 0.024237, 0.023231, 0.022270, 0.021352,
 0.020477, 0.019641, 0.018846, 0.018088, 0.017364, 0.016674, 0.016017, 0.015389, 0.014790,
 0.014219, 0.013674, 0.013153, 0.012656, 0.012181, 0.011728, 0.011294, 0.010881, 0.010486,
 0.010108, 0.009747, 0.009401, 0.009070, 0.008754, 0.028239, 0.027083, 0.025976, 0.024911,
 0.023891, 0.022916, 0.021984, 0.021091, 0.020240, 0.019428, 0.018651, 0.017909, 0.017201,
 0.016525, 0.015880, 0.015263, 0.014674, 0.014111, 0.013575, 0.013063, 0.012574, 0.012108,
 0.011662, 0.011236, 0.010828, 0.010439, 0.010066, 0.009709, 0.009368, 0.009041, 0.008729,
 0.027716, 0.026603, 0.025533, 0.024503, 0.023517, 0.022570, 0.021666, 0.020799, 0.019970,
 0.019178, 0.018420, 0.017697, 0.017006, 0.016346, 0.015716, 0.015113, 0.014538, 0.013988,
 0.013463, 0.012961, 0.012481, 0.012023, 0.011584, 0.011165, 0.010764, 0.010381, 0.010014,
 0.009663, 0.009326, 0.009004, 0.008695, 0.027180, 0.026103, 0.025066, 0.024071, 0.023116,
 0.022198, 0.021321, 0.020482, 0.019679, 0.018910, 0.018173, 0.017469, 0.016796, 0.016153,
 0.015537, 0.014948, 0.014385, 0.013846, 0.013332, 0.012840, 0.012371, 0.011921, 0.011490,
 0.011078, 0.010684, 0.010307, 0.009946, 0.009601, 0.009270, 0.008953, 0.008648, 0.026651,
 0.025615, 0.024614, 0.023651, 0.022724, 0.021836, 0.020986, 0.020171, 0.019389, 0.018640,
 0.017922, 0.017236, 0.016579, 0.015949, 0.015347, 0.014772, 0.014222, 0.013697, 0.013194,
 0.012713, 0.012253, 0.011813, 0.011391, 0.010988, 0.010601, 0.010230, 0.009875, 0.009534,
 0.009209, 0.008897, 0.008597, 0.026127, 0.025130, 0.024164, 0.023236, 0.022342, 0.021482,
 0.020658, 0.019865, 0.019104, 0.018377, 0.017678, 0.017009, 0.016370, 0.015758, 0.015171,
 0.014609, 0.014071, 0.013556, 0.013064, 0.012593, 0.012142, 0.011709, 0.011294, 0.010897,
 0.010518, 0.010155, 0.009806, 0.009472, 0.009151, 0.008843, 0.008548, 0.025660, 0.024699,
 0.023764, 0.022859, 0.021996, 0.021162, 0.020357, 0.019583, 0.018846, 0.018138, 0.017457,
 0.016803, 0.016176, 0.015576, 0.015003, 0.014455, 0.013930, 0.013425, 0.012942, 0.012479,
 0.012036, 0.011610, 0.011204, 0.010815, 0.010442, 0.010084, 0.009741, 0.009412, 0.009096,
 0.008792, 0.008501, 0.025180, 0.024247, 0.023348, 0.022476, 0.021632, 0.020821, 0.020043,
 0.019293, 0.018572, 0.017882, 0.017220, 0.016583, 0.015971, 0.015388, 0.014829, 0.014293,
 0.013777, 0.013283, 0.012808, 0.012356, 0.011923, 0.011507, 0.011108, 0.010725, 0.010357,
 0.010004, 0.009666, 0.009342, 0.009032, 0.008734, 0.008447, 0.024659, 0.023767, 0.022898,
 0.022052, 0.021238, 0.020458, 0.019706, 0.018980, 0.018280, 0.017607, 0.016963, 0.016344,
 0.015753, 0.015185, 0.014639, 0.014114, 0.013610, 0.013126, 0.012664, 0.012221, 0.011796,
 0.011388, 0.010997, 0.010623, 0.010264, 0.009919, 0.009588, 0.009269, 0.008964, 0.008670,
 0.008387, 0.024133, 0.023268, 0.022428, 0.021617, 0.020832, 0.020076, 0.019346, 0.018645,
 0.017967, 0.017317, 0.016692, 0.016090, 0.015514, 0.014960, 0.014428, 0.013916, 0.013427,
 0.012957, 0.012506, 0.012072, 0.011657, 0.011259, 0.010877, 0.010509, 0.010156, 0.009817,
 0.009493, 0.009181, 0.008882, 0.008594, 0.008317, 0.023690, 0.022853, 0.022041, 0.021256,
 0.020495, 0.019761, 0.019050, 0.018369, 0.017710, 0.017076, 0.016467, 0.015880, 0.015315,
 0.014774, 0.014255, 0.013756, 0.013276, 0.012815, 0.012374, 0.011950, 0.011543, 0.011152,
 0.010775, 0.010415, 0.010069, 0.009737, 0.009417, 0.009110, 0.008815, 0.008530, 0.008257,
 0.023205, 0.022399, 0.021617, 0.020858, 0.020120, 0.019410, 0.018723, 0.018060, 0.017420,
 0.016805, 0.016213, 0.015643, 0.015093, 0.014566, 0.014060, 0.013573, 0.013106, 0.012656,
 0.012223, 0.011807, 0.011409, 0.011027, 0.010659, 0.010306, 0.009967, 0.009640, 0.009326,
 0.009024, 0.008734, 0.008456, 0.008188, 0.022747, 0.021973, 0.021218, 0.020480, 0.019765,
 0.019079, 0.018415, 0.017770, 0.017145, 0.016547, 0.015972, 0.015419, 0.014885, 0.014370,
 0.013873, 0.013398, 0.012940, 0.012500, 0.012080, 0.011675, 0.011286, 0.010910, 0.010550,
 0.010202, 0.009868, 0.009548, 0.009240, 0.008944, 0.008659, 0.008385, 0.008122, 0.022256,
 0.021510, 0.020781, 0.020068, 0.019377, 0.018713, 0.018070, 0.017448, 0.016849, 0.016268,
 0.015710, 0.015170, 0.014648, 0.014146, 0.013664, 0.013202, 0.012756, 0.012329, 0.011917,
 0.011521, 0.011141, 0.010774, 0.010423, 0.010084, 0.009758, 0.009445, 0.009144, 0.008854,
 0.008575, 0.008306, 0.008047, 0.021863, 0.021139, 0.020433, 0.019747, 0.019079, 0.018433,
 0.017806, 0.017200, 0.016615, 0.016049, 0.015504, 0.014978, 0.014470, 0.013981, 0.013512,
 0.013059, 0.012623, 0.012203, 0.011799, 0.011409, 0.011034, 0.010673, 0.010327, 0.009993,
 0.009673, 0.009365, 0.009068, 0.008783, 0.008508, 0.008243, 0.007989, 0.021450, 0.020751,
 0.020068, 0.019400, 0.018752, 0.018123, 0.017513, 0.016922, 0.016350, 0.015799, 0.015266,
 0.014754, 0.014260, 0.013785, 0.013326, 0.012884, 0.012459, 0.012048, 0.011652, 0.011272,
 0.010906, 0.010554, 0.010215, 0.009888, 0.009573, 0.009271, 0.008979, 0.008699, 0.008430,
 0.008170, 0.007919, 0.020948, 0.020277, 0.019620, 0.018978, 0.018356, 0.017748, 0.017163,
 0.016593, 0.016039, 0.015509, 0.014994, 0.014496, 0.014019, 0.013557, 0.013111, 0.012679,
 0.012263, 0.011864, 0.011480, 0.011109, 0.010752, 0.010410, 0.010080, 0.009762, 0.009455,
 0.009159, 0.008874, 0.008599, 0.008335, 0.008081, 0.007835, 0.020507, 0.019860, 0.019229,
 0.018611, 0.018008, 0.017421, 0.016855, 0.016302, 0.015764, 0.015249, 0.014749, 0.014266,
 0.013799, 0.013349, 0.012915, 0.012498, 0.012094, 0.011703, 0.011326, 0.010964, 0.010616,
 0.010280, 0.009956, 0.009644, 0.009344, 0.009055, 0.008775, 0.008507, 0.008247, 0.007998,
 0.007757, 0.020181, 0.019550, 0.018932, 0.018330, 0.017740, 0.017171, 0.016614, 0.016073,
 0.015553, 0.015050, 0.014562, 0.014088, 0.013632, 0.013193, 0.012768, 0.012356, 0.011958,
 0.011576, 0.011209, 0.010855, 0.010512, 0.010181, 0.009862, 0.009556, 0.009261, 0.008977,
 0.008702, 0.008437, 0.008182, 0.007935, 0.007697, 0.019734, 0.019126, 0.018530, 0.017949,
 0.017386, 0.016836, 0.016297, 0.015773, 0.015268, 0.014778, 0.014305, 0.013849, 0.013406,
 0.012976, 0.012560, 0.012160, 0.011774, 0.011402, 0.011044, 0.010698, 0.010364, 0.010041,
 0.009730, 0.009431, 0.009142, 0.008863, 0.008594, 0.008335, 0.008085, 0.007844, 0.007612,
 0.019303, 0.018718, 0.018148, 0.017587, 0.017039, 0.016507, 0.015988, 0.015484, 0.014994,
 0.014519, 0.014059, 0.013613, 0.013183, 0.012767, 0.012364, 0.011975, 0.011599, 0.011237,
 0.010887, 0.010548, 0.010221, 0.009906, 0.009602, 0.009309, 0.009027, 0.008754, 0.008491,
 0.008238, 0.007994, 0.007758, 0.007529, 0.018962, 0.018397, 0.017841, 0.017298, 0.016766,
 0.016249, 0.015744, 0.015252, 0.014775, 0.014310, 0.013861, 0.013427, 0.013004, 0.012597,
 0.012203, 0.011824, 0.011457, 0.011103, 0.010759, 0.010429, 0.010109, 0.009801, 0.009504,
 0.009216, 0.008939, 0.008671, 0.008413, 0.008164, 0.007924, 0.007691, 0.007467, 0.018614,
 0.018063, 0.017525, 0.016998, 0.016480, 0.015978, 0.015487, 0.015008, 0.014541, 0.014090,
 0.013652, 0.013230, 0.012820, 0.012422, 0.012037, 0.011666, 0.011308, 0.010960, 0.010625,
 0.010301, 0.009987, 0.009685, 0.009393, 0.009111, 0.008839, 0.008576, 0.008323, 0.008079,
 0.007843, 0.007615, 0.007395, 0.018151, 0.017625, 0.017108, 0.016602, 0.016105, 0.015617,
 0.015144, 0.014684, 0.014237, 0.013802, 0.013378, 0.012967, 0.012570, 0.012186, 0.011814,
 0.011453, 0.011106, 0.010770, 0.010443, 0.010126, 0.009822, 0.009528, 0.009244, 0.008971,
 0.008706, 0.008450, 0.008202, 0.007964, 0.007734, 0.007511, 0.007296, 0.017807, 0.017299,
 0.016798, 0.016305, 0.015821, 0.015348, 0.014886, 0.014439, 0.014001, 0.013578, 0.013165,
 0.012766, 0.012379, 0.012003, 0.011641, 0.011288, 0.010948, 0.010619, 0.010301, 0.009993,
 0.009696, 0.009408, 0.009130, 0.008861, 0.008601, 0.008351, 0.008109, 0.007875, 0.007649,
 0.007430, 0.007219, 0.017466, 0.016972, 0.016486, 0.016010, 0.015543, 0.015089, 0.014641,
 0.014205, 0.013780, 0.013369, 0.012967, 0.012581, 0.012204, 0.011838, 0.011481, 0.011139,
 0.010806, 0.010483, 0.010172, 0.009871, 0.009579, 0.009298, 0.009027, 0.008764, 0.008510,
 0.008263, 0.008025, 0.007795, 0.007573, 0.007359, 0.007151, 0.017089, 0.016615, 0.016146,
 0.015687, 0.015236, 0.014795, 0.014362, 0.013942, 0.013530, 0.013129, 0.012739, 0.012362,
 0.011996, 0.011640, 0.011293, 0.010960, 0.010637, 0.010323, 0.010020, 0.009727, 0.009443,
 0.009168, 0.008901, 0.008643, 0.008395, 0.008155, 0.007922, 0.007697, 0.007479, 0.007269,
 0.007066, 0.016870, 0.016405, 0.015947, 0.015497, 0.015053, 0.014619, 0.014195, 0.013781,
 0.013379, 0.012985, 0.012603, 0.012233, 0.011871, 0.011522, 0.011183, 0.010854, 0.010533,
 0.010226, 0.009928, 0.009638, 0.009357, 0.009086, 0.008826, 0.008573, 0.008328, 0.008090,
 0.007860, 0.007638, 0.007424, 0.007218, 0.007017, 0.016486, 0.016042, 0.015598, 0.015165,
 0.014736, 0.014319, 0.013908, 0.013507, 0.013117, 0.012735, 0.012368, 0.012009, 0.011658,
 0.011319, 0.010991, 0.010672, 0.010361, 0.010061, 0.009772, 0.009491, 0.009218, 0.008953,
 0.008697, 0.008450, 0.008212, 0.007980, 0.007755, 0.007537, 0.007327, 0.007125, 0.006930,
 0.016094, 0.015662, 0.015237, 0.014820, 0.014410, 0.014004, 0.013609, 0.013222, 0.012844,
 0.012478, 0.012120, 0.011769, 0.011431, 0.011103, 0.010783, 0.010471, 0.010172, 0.009881,
 0.009599, 0.009325, 0.009058, 0.008802, 0.008555, 0.008315, 0.008082, 0.007856, 0.007637,
 0.007424, 0.007220, 0.007022, 0.006831, 0.015863, 0.015444, 0.015031, 0.014619, 0.014220,
 0.013825, 0.013434, 0.013058, 0.012689, 0.012327, 0.011979, 0.011638, 0.011304, 0.010978,
 0.010666, 0.010363, 0.010067, 0.009780, 0.009500, 0.009232, 0.008973, 0.008721, 0.008476,
 0.008238, 0.008008, 0.007785, 0.007571, 0.007364, 0.007163, 0.006968, 0.006778, 0.015498,
 0.015096, 0.014699, 0.014302, 0.013914, 0.013534, 0.013158, 0.012794, 0.012439, 0.012090,
 0.011747, 0.011415, 0.011096, 0.010783, 0.010478, 0.010180, 0.009894, 0.009616, 0.009347,
 0.009085, 0.008830, 0.008582, 0.008344, 0.008113, 0.007890, 0.007675, 0.007465, 0.007262,
 0.007064, 0.006872, 0.006686, 0.015223, 0.014833, 0.014447, 0.014061, 0.013683, 0.013316,
 0.012951, 0.012591, 0.012246, 0.011908, 0.011577, 0.011251, 0.010933, 0.010629, 0.010333,
 0.010044, 0.009762, 0.009487, 0.009222, 0.008967, 0.008720, 0.008480, 0.008246, 0.008019,
 0.007798, 0.007584, 0.007378, 0.007178, 0.006985, 0.006798, 0.006618, 0.014991, 0.014615,
 0.014237, 0.013861, 0.013492, 0.013132, 0.012776, 0.012425, 0.012084, 0.011754, 0.011430,
 0.011114, 0.010803, 0.010502, 0.010211, 0.009930, 0.009656, 0.009389, 0.009129, 0.008877,
 0.008632, 0.008394, 0.008164, 0.007942, 0.007726, 0.007518, 0.007315, 0.007119, 0.006929,
 0.006744, 0.006565, 0.014573, 0.014211, 0.013848, 0.013484, 0.013134, 0.012791, 0.012451,
 0.012114, 0.011782, 0.011462, 0.011152, 0.010850, 0.010555, 0.010265, 0.009982, 0.009705,
 0.009436, 0.009178, 0.008929, 0.008687, 0.008451, 0.008223, 0.008000, 0.007784, 0.007573,
 0.007368, 0.007169, 0.006978, 0.006794, 0.006615, 0.006441, 0.014351, 0.014000, 0.013645,
 0.013289, 0.012940, 0.012604, 0.012277, 0.011952, 0.011631, 0.011314, 0.011002, 0.010703,
 0.010415, 0.010132, 0.009859, 0.009593, 0.009333, 0.009079, 0.008831, 0.008590, 0.008354,
 0.008129, 0.007910, 0.007698, 0.007493, 0.007294, 0.007101, 0.006914, 0.006732, 0.006557,
 0.006386, 0.014078, 0.013739, 0.013397, 0.013053, 0.012710, 0.012375, 0.012057, 0.011742,
 0.011433, 0.011132, 0.010836, 0.010545, 0.010259, 0.009979, 0.009705, 0.009440, 0.009186,
 0.008938, 0.008699, 0.008468, 0.008242, 0.008022, 0.007808, 0.007601, 0.007401, 0.007207,
 0.007017, 0.006833, 0.006655, 0.006481, 0.006312, 0.013806, 0.013476, 0.013150, 0.012823,
 0.012498, 0.012174, 0.011852, 0.011533, 0.011225, 0.010930, 0.010642, 0.010360, 0.010086,
 0.009819, 0.009557, 0.009302, 0.009056, 0.008815, 0.008580, 0.008354, 0.008133, 0.007917,
 0.007708, 0.007504, 0.007307, 0.007115, 0.006928, 0.006747, 0.006570, 0.006398, 0.006231,
 0.013511, 0.013192, 0.012873, 0.012557, 0.012245, 0.011937, 0.011633, 0.011334, 0.011042,
 0.010755, 0.010474, 0.010200, 0.009932, 0.009670, 0.009415, 0.009166, 0.008924, 0.008690,
 0.008460, 0.008237, 0.008020, 0.007810, 0.007605, 0.007407, 0.007213, 0.007026, 0.006844,
 0.006666, 0.006493, 0.006325, 0.006162, 0.013311, 0.012995, 0.012682, 0.012370, 0.012061,
 0.011758, 0.011459, 0.011164, 0.010876, 0.010594, 0.010317, 0.010048, 0.009784, 0.009526,
 0.009276, 0.009031, 0.008793, 0.008562, 0.008337, 0.008118, 0.007906, 0.007699, 0.007498,
 0.007303, 0.007114, 0.006930, 0.006751, 0.006578, 0.006409, 0.006246, 0.006087, 0.013008,
 0.012700, 0.012402, 0.012108, 0.011815, 0.011525, 0.011237, 0.010954, 0.010675, 0.010402,
 0.010135, 0.009872, 0.009617, 0.009367, 0.009125, 0.008888, 0.008656, 0.008429, 0.008209,
 0.007995, 0.007787, 0.007584, 0.007388, 0.007197, 0.007012, 0.006832, 0.006657, 0.006486,
 0.006322, 0.006162, 0.006006, 0.012769, 0.012477, 0.012192, 0.011904, 0.011615, 0.011331,
 0.011048, 0.010768, 0.010494, 0.010225, 0.009962, 0.009704, 0.009452, 0.009212, 0.008977,
 0.008749, 0.008526, 0.008307, 0.008093, 0.007884, 0.007682, 0.007485, 0.007293, 0.007106,
 0.006924, 0.006747, 0.006576, 0.006409, 0.006247, 0.006091, 0.005938, 0.012510, 0.012225,
 0.011941, 0.011657, 0.011373, 0.011094, 0.010827, 0.010561, 0.010299, 0.010039, 0.009786,
 0.009537, 0.009291, 0.009054, 0.008822, 0.008595, 0.008378, 0.008166, 0.007958, 0.007756,
 0.007558, 0.007365, 0.007178, 0.006997, 0.006819, 0.006646, 0.006479, 0.006316, 0.006158,
 0.006004, 0.005855, 0.012405, 0.012120, 0.011844, 0.011570, 0.011293, 0.011016, 0.010743,
 0.010481, 0.010223, 0.009970, 0.009720, 0.009473, 0.009231, 0.008994, 0.008766, 0.008545,
 0.008329, 0.008119, 0.007914, 0.007712, 0.007515, 0.007324, 0.007137, 0.006956, 0.006781,
 0.006609, 0.006445, 0.006285, 0.006129, 0.005978, 0.005831, 0.012128, 0.011852, 0.011586,
 0.011317, 0.011048, 0.010781, 0.010525, 0.010271, 0.010019, 0.009768, 0.009522, 0.009286,
 0.009056, 0.008830, 0.008607, 0.008389, 0.008177, 0.007969, 0.007767, 0.007574, 0.007385,
 0.007200, 0.007019, 0.006843, 0.006672, 0.006506, 0.006344, 0.006186, 0.006032, 0.005885,
 0.005742, 0.011893, 0.011632, 0.011366, 0.011106, 0.010849, 0.010591, 0.010335, 0.010088,
 0.009844, 0.009602, 0.009363, 0.009131, 0.008907, 0.008686, 0.008469, 0.008256, 0.008049,
 0.007848, 0.007652, 0.007463, 0.007277, 0.007095, 0.006918, 0.006745, 0.006579, 0.006417,
 0.006258, 0.006105, 0.005956, 0.005812, 0.005670, 0.011745, 0.011484, 0.011230, 0.010973,
 0.010714, 0.010465, 0.010216, 0.009971, 0.009732, 0.009495, 0.009262, 0.009031, 0.008810,
 0.008594, 0.008381, 0.008172, 0.007966, 0.007769, 0.007577, 0.007390, 0.007206, 0.007027,
 0.006852, 0.006685, 0.006521, 0.006361, 0.006205, 0.006053, 0.005905, 0.005761, 0.005621,
 0.011475, 0.011224, 0.010978, 0.010730, 0.010485, 0.010242, 0.010000, 0.009765, 0.009533,
 0.009302, 0.009078, 0.008857, 0.008641, 0.008428, 0.008222, 0.008020, 0.007823, 0.007630,
 0.007442, 0.007260, 0.007082, 0.006907, 0.006738, 0.006573, 0.006412, 0.006257, 0.006105,
 0.005957, 0.005813, 0.005673, 0.005537, 0.011336, 0.011092, 0.010849, 0.010606, 0.010365,
 0.010127, 0.009889, 0.009658, 0.009429, 0.009202, 0.008982, 0.008765, 0.008550, 0.008340,
 0.008138, 0.007939, 0.007744, 0.007553, 0.007370, 0.007190, 0.007014, 0.006842, 0.006674,
 0.006513, 0.006355, 0.006201, 0.006051, 0.005905, 0.005763, 0.005625, 0.005491, 0.011069,
 0.010835, 0.010601, 0.010366, 0.010131, 0.009900, 0.009672, 0.009447, 0.009226, 0.009008,
 0.008794, 0.008584, 0.008380, 0.008178, 0.007979, 0.007784, 0.007596, 0.007412, 0.007233,
 0.007058, 0.006886, 0.006720, 0.006557, 0.006400, 0.006246, 0.006096, 0.005950, 0.005807,
 0.005668, 0.005533, 0.005403, 0.010926, 0.010695, 0.010462, 0.010233, 0.010004, 0.009779,
 0.009553, 0.009332, 0.009115, 0.008903, 0.008692, 0.008484, 0.008282, 0.008083, 0.007888,
 0.007699, 0.007513, 0.007331, 0.007156, 0.006984, 0.006815, 0.006650, 0.006491, 0.006336,
 0.006184, 0.006036, 0.005891, 0.005753, 0.005617, 0.005484, 0.005355, 0.010697, 0.010476,
 0.010253, 0.010031, 0.009810, 0.009590, 0.009373, 0.009158, 0.008947, 0.008739, 0.008534,
 0.008334, 0.008135, 0.007944, 0.007755, 0.007569, 0.007390, 0.007213, 0.007039, 0.006872,
 0.006708, 0.006548, 0.006391, 0.006240, 0.006092, 0.005948, 0.005806, 0.005669, 0.005537,
 0.005407, 0.005281, 0.010555, 0.010336, 0.010120, 0.009904, 0.009685, 0.009470, 0.009259,
 0.009048, 0.008838, 0.008633, 0.008431, 0.008235, 0.008044, 0.007854, 0.007668, 0.007484,
 0.007306, 0.007132, 0.006963, 0.006797, 0.006636, 0.006480, 0.006328, 0.006178, 0.006031,
 0.005888, 0.005749, 0.005615, 0.005483, 0.005357, 0.005233, 0.010281, 0.010072, 0.009864,
 0.009655, 0.009446, 0.009239, 0.009032, 0.008828, 0.008628, 0.008431, 0.008239, 0.008048,
 0.007862, 0.007678, 0.007499, 0.007323, 0.007152, 0.006982, 0.006818, 0.006658, 0.006501,
 0.006348, 0.006200, 0.006056, 0.005914, 0.005776, 0.005642, 0.005512, 0.005384, 0.005259,
 0.005137, 0.010162, 0.009955, 0.009747, 0.009540, 0.009335, 0.009131, 0.008928, 0.008731,
 0.008536, 0.008342, 0.008153, 0.007964, 0.007781, 0.007600, 0.007422, 0.007249, 0.007080,
 0.006914, 0.006752, 0.006594, 0.006440, 0.006289, 0.006143, 0.006000, 0.005860, 0.005722,
 0.005590, 0.005462, 0.005336, 0.005215, 0.005096, 0.010045, 0.009843, 0.009639, 0.009440,
 0.009239, 0.009037, 0.008840, 0.008644, 0.008449, 0.008258, 0.008071, 0.007886, 0.007704,
 0.007526, 0.007353, 0.007184, 0.007017, 0.006853, 0.006694, 0.006539, 0.006387, 0.006239,
 0.006094, 0.005952, 0.005815, 0.005681, 0.005550, 0.005423, 0.005299, 0.005178, 0.005059,
 0.009783, 0.009592, 0.009396, 0.009201, 0.009007, 0.008814, 0.008623, 0.008432, 0.008246,
 0.008062, 0.007881, 0.007703, 0.007527, 0.007355, 0.007186, 0.007023, 0.006863, 0.006705,
 0.006550, 0.006398, 0.006251, 0.006107, 0.005966, 0.005830, 0.005697, 0.005566, 0.005439,
 0.005315, 0.005194, 0.005076, 0.004961, 0.009636, 0.009444, 0.009252, 0.009064, 0.008874,
 0.008685, 0.008498, 0.008313, 0.008130, 0.007949, 0.007774, 0.007600, 0.007428, 0.007260,
 0.007095, 0.006933, 0.006776, 0.006621, 0.006470, 0.006322, 0.006178, 0.006037, 0.005899,
 0.005763, 0.005631, 0.005502, 0.005376, 0.005254, 0.005136, 0.005019, 0.004907, 0.009518,
 0.009332, 0.009143, 0.008957, 0.008772, 0.008587, 0.008404, 0.008222, 0.008043, 0.007864,
 0.007688, 0.007516, 0.007347, 0.007183, 0.007021, 0.006862, 0.006707, 0.006554, 0.006405,
 0.006259, 0.006117, 0.005978, 0.005841, 0.005708, 0.005578, 0.005452, 0.005329, 0.005208,
 0.005091, 0.004977, 0.004867, 0.009376, 0.009196, 0.009014, 0.008831, 0.008650, 0.008471,
 0.008291, 0.008113, 0.007938, 0.007765, 0.007593, 0.007424, 0.007259, 0.007097, 0.006938,
 0.006781, 0.006628, 0.006478, 0.006332, 0.006189, 0.006049, 0.005912, 0.005779, 0.005648,
 0.005521, 0.005397, 0.005276, 0.005158, 0.005042, 0.004929, 0.004820, 0.009125, 0.008951,
 0.008776, 0.008600, 0.008426, 0.008250, 0.008078, 0.007905, 0.007735, 0.007567, 0.007403,
 0.007239, 0.007080, 0.006924, 0.006769, 0.006619, 0.006470, 0.006326, 0.006185, 0.006046,
 0.005910, 0.005778, 0.005649, 0.005523, 0.005399, 0.005278, 0.005161, 0.005047, 0.004935,
 0.004825, 0.004719, 0.008986, 0.008817, 0.008644, 0.008474, 0.008302, 0.008131, 0.007963,
 0.007794, 0.007627, 0.007464, 0.007303, 0.007142, 0.006985, 0.006833, 0.006682, 0.006533,
 0.006388, 0.006246, 0.006107, 0.005972, 0.005838, 0.005708, 0.005581, 0.005457, 0.005336,
 0.005218, 0.005103, 0.004990, 0.004879, 0.004772, 0.004667, 0.008866, 0.008698, 0.008531,
 0.008362, 0.008196, 0.008029, 0.007864, 0.007697, 0.007533, 0.007373, 0.007215, 0.007060,
 0.006907, 0.006756, 0.006606, 0.006460, 0.006319, 0.006181, 0.006044, 0.005909, 0.005780,
 0.005652, 0.005526, 0.005403, 0.005284, 0.005168, 0.005054, 0.004944, 0.004836, 0.004730,
 0.004627, 0.008718, 0.008555, 0.008392, 0.008229, 0.008067, 0.007904, 0.007744, 0.007583,
 0.007425, 0.007268, 0.007113, 0.006960, 0.006810, 0.006662, 0.006516, 0.006371, 0.006228,
 0.006091, 0.005957, 0.005826, 0.005697, 0.005572, 0.005450, 0.005330, 0.005213, 0.005099,
 0.004988, 0.004879, 0.004773, 0.004669, 0.004568, 0.008581, 0.008421, 0.008260, 0.008103,
 0.007944, 0.007786, 0.007627, 0.007469, 0.007313, 0.007158, 0.007006, 0.006854, 0.006707,
 0.006561, 0.006418, 0.006279, 0.006141, 0.006007, 0.005877, 0.005749, 0.005624, 0.005502,
 0.005381, 0.005265, 0.005150, 0.005039, 0.004929, 0.004822, 0.004718, 0.004616, 0.004517,
 0.008466, 0.008309, 0.008155, 0.007998, 0.007841, 0.007685, 0.007530, 0.007374, 0.007221,
 0.007069, 0.006919, 0.006772, 0.006628, 0.006486, 0.006347, 0.006209, 0.006074, 0.005941,
 0.005812, 0.005686, 0.005564, 0.005443, 0.005324, 0.005208, 0.005095, 0.004985, 0.004877,
 0.004772, 0.004668, 0.004569, 0.004471, 0.008334, 0.008181, 0.008027, 0.007873, 0.007721,
 0.007569, 0.007415, 0.007265, 0.007114, 0.006966, 0.006821, 0.006678, 0.006536, 0.006396,
 0.006260, 0.006125, 0.005994, 0.005865, 0.005738, 0.005615, 0.005494, 0.005376, 0.005259,
 0.005146, 0.005035, 0.004927, 0.004820, 0.004717, 0.004617, 0.004518, 0.004421, 0.008218,
 0.008066, 0.007920, 0.007770, 0.007619, 0.007469, 0.007317, 0.007168, 0.007024, 0.006879,
 0.006734, 0.006592, 0.006454, 0.006316, 0.006179, 0.006048, 0.005919, 0.005793, 0.005669,
 0.005547, 0.005427, 0.005310, 0.005197, 0.005086, 0.004976, 0.004868, 0.004763, 0.004661,
 0.004563, 0.004466, 0.004371, 0.008080, 0.007934, 0.007786, 0.007640, 0.007494, 0.007349,
 0.007204, 0.007059, 0.006916, 0.006775, 0.006635, 0.006496, 0.006359, 0.006225, 0.006092,
 0.005963, 0.005837, 0.005713, 0.005591, 0.005472, 0.005356, 0.005242, 0.005129, 0.005021,
 0.004914, 0.004809, 0.004707, 0.004608, 0.004510, 0.004415, 0.004322, 0.007946, 0.007808,
 0.007665, 0.007522, 0.007377, 0.007232, 0.007088, 0.006947, 0.006808, 0.006671, 0.006534,
 0.006398, 0.006265, 0.006132, 0.006003, 0.005876, 0.005751, 0.005630, 0.005512, 0.005396,
 0.005281, 0.005168, 0.005059, 0.004951, 0.004846, 0.004743, 0.004643, 0.004545, 0.004448,
 0.004355, 0.004263, 0.007833, 0.007695, 0.007556, 0.007416, 0.007275, 0.007135, 0.006994,
 0.006856, 0.006718, 0.006583, 0.006448, 0.006316, 0.006186, 0.006057, 0.005931, 0.005806,
 0.005685, 0.005566, 0.005448, 0.005332, 0.005221, 0.005111, 0.005003, 0.004897, 0.004794,
 0.004693, 0.004594, 0.004497, 0.004403, 0.004312, 0.004222, 0.007713, 0.007579, 0.007446,
 0.007308, 0.007168, 0.007032, 0.006897, 0.006761, 0.006626, 0.006494, 0.006361, 0.006228,
 0.006100, 0.005974, 0.005850, 0.005729, 0.005610, 0.005492, 0.005376, 0.005264, 0.005154,
 0.005045, 0.004937, 0.004834, 0.004733, 0.004634, 0.004537, 0.004442, 0.004350, 0.004260,
 0.004172, 0.007587, 0.007455, 0.007320, 0.007187, 0.007053, 0.006918, 0.006785, 0.006653,
 0.006521, 0.006391, 0.006265, 0.006139, 0.006012, 0.005887, 0.005766, 0.005646, 0.005528,
 0.005413, 0.005302, 0.005192, 0.005084, 0.004977, 0.004872, 0.004771, 0.004672, 0.004576,
 0.004482, 0.004389, 0.004297, 0.004208, 0.004121, 0.007468, 0.007341, 0.007211, 0.007077,
 0.006948, 0.006818, 0.006685, 0.006554, 0.006427, 0.006300, 0.006173, 0.006046, 0.005923,
 0.005804, 0.005686, 0.005568, 0.005452, 0.005337, 0.005228, 0.005121, 0.005015, 0.004912,
 0.004810, 0.004710, 0.004612, 0.004515, 0.004421, 0.004331, 0.004242, 0.004155, 0.004070,
 0.007337, 0.007216, 0.007091, 0.006961, 0.006828, 0.006697, 0.006572, 0.006447, 0.006322,
 0.006196, 0.006069, 0.005944, 0.005824, 0.005706, 0.005592, 0.005479, 0.005367, 0.005258,
 0.005149, 0.005042, 0.004936, 0.004834, 0.004735, 0.004637, 0.004542, 0.004450, 0.004359,
 0.004270, 0.004183, 0.004098, 0.004015, 0.007186, 0.007068, 0.006947, 0.006824, 0.006702,
 0.006578, 0.006454, 0.006331, 0.006209, 0.006087, 0.005964, 0.005841, 0.005721, 0.005606,
 0.005494, 0.005383, 0.005273, 0.005167, 0.005062, 0.004959, 0.004858, 0.004759, 0.004662,
 0.004566, 0.004474, 0.004383, 0.004294, 0.004206, 0.004120, 0.004037, 0.003955, 0.007088,
 0.006970, 0.006849, 0.006727, 0.006605, 0.006482, 0.006360, 0.006238, 0.006117, 0.005998,
 0.005879, 0.005763, 0.005647, 0.005534, 0.005423, 0.005313, 0.005205, 0.005099, 0.004996,
 0.004894, 0.004794, 0.004696, 0.004601, 0.004507, 0.004415, 0.004325, 0.004237, 0.004151,
 0.004067, 0.003985, 0.003905 };


static double ematrix[7][46] = {	// Beer's law interpolation matrix, short path
	1.00691, 1.00257, 1.00076, 1.0012, 1.00368, 1.00796, 1.01384, 1.02112, 1.02961,
	1.03915, 1.04957, 1.06074, 1.07252, 1.0848, 1.09748, 1.11047, 1.12369, 1.13709,
	1.1506, 1.16421, 1.17788, 1.19161, 1.20541, 1.21929, 1.2333, 1.24746, 1.26186,
	1.27655, 1.29163, 1.30719, 1.32336, 1.34026, 1.35802, 1.37682, 1.3968, 1.41817,
	1.4411, 1.46582, 1.49253, 1.52149, 1.55294, 1.58714, 1.62437, 1.66492, 1.70909,
	1.7572, 0.99326, 1.00484, 1.01615, 1.02726, 1.03823, 1.04913, 1.06004, 1.07102,
	1.08214, 1.09348, 1.10509, 1.11707, 1.12946, 1.14234, 1.15579, 1.16986, 1.18464,
	1.20019, 1.21657, 1.23387, 1.25214, 1.27147, 1.29191, 1.31354, 1.33643, 1.36065,
	1.38627, 1.41335, 1.44197, 1.47219, 1.5041, 1.53774, 1.57321, 1.61056, 1.64986,
	1.69119, 1.73461, 1.7802, 1.82802, 1.87814, 1.93064, 1.98558, 2.04303, 2.10307,
	2.16575, 2.23116, 0.99903, 1.01348, 1.02735, 1.04076, 1.05382, 1.06663, 1.07929,
	1.09193, 1.10463, 1.11752, 1.1307, 1.14427, 1.15835, 1.17303, 1.18844, 1.20467,
	1.22184, 1.24004, 1.2594, 1.28001, 1.30199, 1.32544, 1.35046, 1.37717, 1.40568,
	1.43609, 1.4685, 1.50304, 1.53979, 1.57888, 1.6204, 1.66448, 1.7112, 1.76069,
	1.81305, 1.86838, 1.92679, 1.9884, 2.05331, 2.12162, 2.19344, 2.26889, 2.34807,
	2.43108, 2.51803, 2.60904, 1.002, 1.03743, 1.05317, 1.06828, 1.08291, 1.0972,
	1.11128, 1.12528, 1.13935, 1.15361, 1.16821, 1.18327, 1.19894, 1.21535, 1.23264,
	1.25093, 1.27038, 1.29111, 1.31325, 1.33696, 1.36235, 1.38957, 1.41875, 1.45003,
	1.48354, 1.51942, 1.55781, 1.59883, 1.64264, 1.68935, 1.73912, 1.79206, 1.84833,
	1.90805, 1.97136, 2.0384, 2.1093, 2.1842, 2.26323, 2.34653, 2.43424, 2.52649,
	2.62341, 2.72515, 2.83183, 2.9436, 1.01319, 1.0257, 1.03891, 1.05285, 1.06756,
	1.08307, 1.09942, 1.11665, 1.13478, 1.15385, 1.1739, 1.19497, 1.21708, 1.24028,
	1.2646, 1.29007, 1.31673, 1.34462, 1.37377, 1.40421, 1.43598, 1.46912, 1.50366,
	1.53964, 1.57709, 1.61605, 1.65654, 1.69862, 1.74231, 1.78764, 1.83466, 1.8834,
	1.93388, 1.98616, 2.04026, 2.09623, 2.15408, 2.21387, 2.27561, 2.33936, 2.40515,
	2.473, 2.54296, 2.61506, 2.68934, 2.76583, 1.0282, 1.04433, 1.0599, 1.0751,
	1.09011, 1.10512, 1.1203, 1.13584, 1.15193, 1.16875, 1.18648, 1.2053, 1.2254,
	1.24696, 1.27017, 1.2952, 1.32225, 1.35149, 1.38312, 1.4173, 1.45423, 1.49409,
	1.53706, 1.58333, 1.63307, 1.68648, 1.74374, 1.80502, 1.87052, 1.94042, 2.01489,
	2.09413, 2.17831, 2.26763, 2.36226, 2.46238, 2.56819, 2.67986, 2.79758, 2.92153,
	3.05189, 3.18885, 3.33259, 3.48329, 3.64115, 3.80633, 1.0282, 1.04433, 1.0599,
	1.0751, 1.09011, 1.10512, 1.1203, 1.13584, 1.15193, 1.16875, 1.18648, 1.2053,
	1.2254, 1.24696, 1.27017, 1.2952, 1.32225, 1.35149, 1.38312, 1.4173, 1.45423,
	1.49409, 1.53706, 1.58333, 1.63307, 1.68648, 1.74374, 1.80502, 1.87052, 1.94042,
	2.01489, 2.09413, 2.17831, 2.26763, 2.36226, 2.46238, 2.56819, 2.67986, 2.79758,
	2.92153, 3.05189, 3.18885, 3.33259, 3.48329, 3.64115, 3.80633 };

double BeersLawBilinearInterp(void);

/*****************************************************************/
/*    LLVMR.c - Gets volume mixing ratio from spectra 	     */
/*****************************************************************/
                  /*  R.D. May, MayComm Instruments, LLC */ 
                          
//         ** This module copyright 2005, MayComm Instruments, LLC **.
//   Source or object codes may not be distributed without express written consent.


/* -------------------------------------------------------------------- */
void nclhInit(var_base *varp)
{
// Assign grid arrays
  double stepP = (Pupper - Plower)/(double)(NPRESSURES-1);   // Pressure steps
  double stepT = (Tupper - Tlower)/(double)(NTEMPS-1);       // Temperature steps

  for (int i = 0; i < NPRESSURES; i++)
    Pgrid[i] = Plower + ((double)i * stepP); // Pressure grid

  for (int j = 0; j < NTEMPS; j++)
    Tgrid[j] = Tlower + ((double)j * stepT);    // Temperature grid

}

/* -------------------------------------------------------------------- */
void snclh_s(DERTBL *varp)	// Interpolates Hmatrix for volume mixing ratio
{
  int indexP, indexT;		// Indices of closest grid points
  int pleft, pright, tleft, tright; // Grid points for interpolation
  double pdiff, tdiff, TairK;
  double pcounts;			// Power zero level and mode purity
  double pdiffmin, tdiffmin, wdiffmin;
  double pprime, response;
  double y1, y2, y3, y4, t, u, pp2fobs, pp2fcalc, fct;

  double pp2f_lhs, pwr_lhs, dk_lhs, pp2f_lhl, pwr_lhl, dk_lhl;

  P_default = 400.0;		// Default to reasonable P
  T_default = 20.0;		// Default to reasonable T
	
  pdiffmin = 5.0e30;
  tdiffmin = 5.0e30;
  wdiffmin = 5.0e30;
	
// First find closest index to current Pair and Tair values (indexP, indexT)
//  	 (after checking for out of bound Pair and Tair numbers)	

  pp2f_lhs = (double)GetSample(varp, 0);
  pwr_lhs = (double)GetSample(varp, 1);
  dk_lhs = (double)GetSample(varp, 2);
  pp2f_lhl = (double)GetSample(varp, 3);
  pwr_lhl = (double)GetSample(varp, 4);
  dk_lhl = (double)GetSample(varp, 5);
  Tair = (double)GetSample(varp, 6);
  Pair = (double)GetSample(varp, 7);

  if (isnan(pp2f_lhs) || isnan(Pair) || isnan(Tair))  // Reality check.
  {
    H2O_vmr_s = H2O_vmr_h = floatNAN;
    PutSample(varp, H2O_vmr_s);
    return;
  }

  TairK = Tair + Kelvin;   // Convert to K for Hmatrix
	
  if (Pair < Plower)
    Pair = P_default;     // Don't allow bad P/T numbers
  if (Pair > Pupper)
    Pair = P_default;

  if (TairK < Tlower)
    {
    Tair = T_default;
    TairK = T_default + Kelvin;    // T-default = C !!
    }
  if (TairK > Tupper)
    {
    Tair = T_default;
    TairK = T_default + Kelvin;
    }

  for (int i = 0; i < NPRESSURES; i++)
  {
    pdiff = fabs((double)(Pgrid[i]-Pair));
    if (pdiff < pdiffmin)
    {
      pdiffmin = pdiff;		// Reset minimum, and
      indexP = i;		// mark its index
    }
  }
	
  for (int j = 0; j < NTEMPS; j++)
  {
    tdiff = fabs((double)(Tgrid[j]-TairK));                               
    if (tdiff < tdiffmin)
    {
      tdiffmin = tdiff;		// Reset minimum, and
      indexT = j;		// mark its index
    }    
  }

    
  if (Pgrid[indexP] <= Pair)       // If closest grid point is left of Pair
  {
    pleft = indexP;
    pright = indexP + 1;
  }
  else                            // If closest grid point is right of Pair
  {
    pleft = indexP - 1;
    pright = indexP; 
  }
    
  if (Tgrid[indexT] <= TairK)       // If closest grid point is left of Tair
  {
    tleft = indexT;
    tright = indexT + 1;
  }
  else                            // If closest grid point is right of Tair
  {
    tleft = indexT - 1;
    tright = indexT; 
  }

  //  Don't let array indices get out of bounds
  if(pleft < 0)pleft = 0;
  if(pright > NPRESSURES-1)pright = NPRESSURES-1;    // C arrays start at zero!
  if(tleft < 0)tleft = 0;
  if(tright > NTEMPS-1)tright = NTEMPS-1;
	
  // Now have the grid square and ready for simple bilinear interpolation
  //  First do short path
  y1 = pmatrix_s[pleft][tleft];
  y2 = pmatrix_s[pright][tleft];
  y3 = pmatrix_s[pright][tright];	
  y4 = pmatrix_s[pleft][tright];

  t = (Pair - Pgrid[pleft])/(Pgrid[pright] - Pgrid[pleft]);  // 0<=t<=1
  u = (TairK - Tgrid[tleft])/(Tgrid[tright] - Tgrid[tleft]); // 0<=u<=1

  // pp2fcalc is interpolated synthetic 2f signal size for mixing ratio of vmrref
  pp2fcalc = ((1.0-t)*(1.0-u)*y1) + (t*(1.0-u)*y2) + (t*u*y3) + ((1.0-t)*u*y4);		

//  Interpolation done, now use calibration "R"-number to get volume mixing ratio (ppmv).
  pcounts = (pwr_lhs - dk_lhs);          // Power, less zero level
  if(pcounts <= 0)
    pcounts = pwr_lhs + 10;	// Force at least 10 counts above zero
  pprime = pcounts;	// Normalized power level (assume mode = 1.0 = OK for DFB lasers)
  response = Rcalb_s * pprime;	// Signal chain response
  if(response > 0.0)
    pp2fobs = pp2f_lhs / response;	// pp2f observed (real units)
  else
    pp2fobs = -10.0;			// Force negative to flag error
  H2O_vmr_s = (pp2fobs / pp2fcalc) * vmrref_s;  // Volume mixing ratio

  // Apply pressure correction from lab cal data
  fct = Pa0_s + (Pa1_s*Pair) + (Pa2_s*Pair*Pair) + (Pa3_s*pow((double)Pair,3)) + (Pa4_s*pow((double)Pair,4));
  H2O_vmr_s = H2O_vmr_s * fct;

// Get high H2O correction factor via interpolation (only short path has this for 11/12/05 HIAPER cals)
  if((H2O_vmr_s > 3000.0) && (Pair > 400.0) && (Pair < 1060))   // Only needed if [H2O] > 3000 ppmv with L = 10.0 cm
  {
    H2O_vmr_s = H2O_vmr_s * BeersLawBilinearInterp();
  }

  if (pcounts < 400.0)			// If Laser power is too low
    H2O_vmr_s = 0.01;			//   ...default to 0.01 ppmv

  //  Then Herriott cell path
  y1 = pmatrix_h[pleft][tleft];
  y2 = pmatrix_h[pright][tleft];
  y3 = pmatrix_h[pright][tright];	
  y4 = pmatrix_h[pleft][tright];
	
  t = (Pair - Pgrid[pleft])/(Pgrid[pright] - Pgrid[pleft]);  // 0<=t<=1
  u = (TairK - Tgrid[tleft])/(Tgrid[tright] - Tgrid[tleft]); // 0<=u<=1

  //	pp2fcalc is interpolated synthetic 2f signal size for mixing ratio of vmrref
  pp2fcalc = ((1.0-t)*(1.0-u)*y1) + (t*(1.0-u)*y2) + (t*u*y3) + ((1.0-t)*u*y4);		

  //  Interpolation done, now use calibration "R"-number to get volume mixing ratio (ppmv)
  pcounts = (pwr_lhl - dk_lhl);	// Power, less zero level
  if(pcounts <= 0)
    pcounts = pwr_lhl + 10;	// Force at least 10 counts above zero
  pprime = pcounts;	// Normalized power level (assume mode = 1.0 = OK for DFB lasers)
  response = Rcalb_h * pprime;	// Signal chain response
  if(response > 0.0)
    pp2fobs = pp2f_lhl / response;	// pp2f observed (real units)
  else
    pp2fobs = -10.0;		// Force negative to flag error

  H2O_vmr_h = (pp2fobs / pp2fcalc) * vmrref_h;  // Volume mixing ratio

  // Apply pressure correction from lab cal data
  fct = Pa0_h + (Pa1_h*Pair) + (Pa2_h*Pair*Pair) +
        (Pa3_h*pow((double)Pair,3)) + (Pa4_h*pow((double)Pair,4));

  H2O_vmr_h = H2O_vmr_h * fct;

  // Apply high H2O calibration polynomial to Hcell channel (HIAPER,
  // generated at 500 mb only, 11/12/05)
  if(H2O_vmr_h > 500.0)		// For 130 cm optical path, only need at > 500 ppmv
    H2O_vmr_h = c0_h + c1_h*H2O_vmr_h + c2_h*H2O_vmr_h*H2O_vmr_h;

  if (pcounts < 400.0)		// If Laser power is too low
    H2O_vmr_h = 0.01;		//   ...default to 0.01 ppmv

  PutSample(varp, H2O_vmr_s / 1608.0);
}

/* -------------------------------------------------------------------- */
void snclh_h(DERTBL *varp)
{
  PutSample(varp, H2O_vmr_h / 1608.0);
}

/* -------------------------------------------------------------------- */
// Below is bilinear interpolation code
double BeersLawBilinearInterp(void)
{
  static const int NP = 7;
  static const int NH2O = 46;
  static const double H2O_default = 6000.0;
  static const double Plower2 = 400.0;
  static const double Pupper2 = 1000.0;
  static const double H2Olower = 2500.0;
  static const double H2Oupper = 25000.0; 

  int indexP, indexH2O, pleft, pright, H2Oleft, H2Oright; 
  double stepP, stepH2O, t, u, y1, y2, y3, y4;
  double beerfactor, pdiffmin = 5.0e30F, H2Odiffmin = 5.0e30F;
  double H2Odiff, pdiff, Present_H2O;

  P_default = 500.0;
  Present_H2O = H2O_vmr_s;     // Use another variable to avoid stomping on H2O_vmr

  // Assign grid arrays
  stepP = (Pupper2 - Plower2) / (double)(NP - 1);	// Pressure steps
  stepH2O = (H2Oupper - H2Olower) / (double)(NH2O - 1);	// H2O steps
  
  // First find closest index to current P and H2O values (indexP, indexT)
  // (after checking for out of bound values)  
  if (Pair < Plower2) Pair = Plower2;	// Don't allow bad P/T numbers
  if (Pair > Pupper2) Pair = Pupper2;
  if (Present_H2O < H2Olower) Present_H2O = H2O_default;
  if (Present_H2O > H2Oupper) Present_H2O = H2O_default;

  for (int i = 0; i < NP; i++)
  {
    pdiff = fabs((double)(Plower2 + (double)i * stepP - Pair));
    if (pdiff < pdiffmin)
    {
       pdiffmin = pdiff;		// Reset minimum, and
       indexP = i;			//    mark its index
    }
  }

  for (int i = 0 ; i < NH2O; i++)
  {
    H2Odiff = fabs((double)(H2Olower + (double)i * stepH2O - Present_H2O));                               
    if (H2Odiff < H2Odiffmin)
    {
       H2Odiffmin = H2Odiff;		// Reset minimum, and
       indexH2O = i;			//    mark its index
    }    
  }

  if (Plower2 + (double)indexP * stepP <= Pair) // If closest grid point is left of Pair
  {
    pleft = indexP;
    pright = indexP + 1;
  }
  else					// If closest grid point is right of Pair
  {
    pleft = indexP - 1;
    pright = indexP; 
  }

  if ((H2Olower + (double)indexH2O * stepH2O) <= Present_H2O)  // If closest grid point is left of Tair
  {
    H2Oleft = indexH2O;
    H2Oright = indexH2O + 1;
  }
  else					// If closest grid point is right of Tair
  {
    H2Oleft = indexH2O - 1;
    H2Oright = indexH2O; 
  }

  //  Don't let array indices get out of bounds
  if (pleft < 0)         pleft = 0;
  if (pright > NP - 1)   pright = NP-1;        // C arrays start at zero!
  if (H2Oleft < 0)       H2Oleft = 0;
  if( H2Oright > NH2O-1) H2Oright = NH2O-1;

// Finally, don't allow equal values for pleft/pright
  if((pleft == pright) && (pleft == 0))	// If P at low end
  {
  	beerfactor = ematrix[pleft][H2Oleft];
	return  beerfactor;
  }
  if((pleft == pright) && (pright == NP-1))	// If P at high end
  {
  	beerfactor = ematrix[pright][H2Oleft];
	return  beerfactor;
  }

  // Now have the grid square and ready for simple bilinear interpolation
  y1 = ematrix[pleft][H2Oleft];
  y2 = ematrix[pright][H2Oleft];
  y3 = ematrix[pright][H2Oright];  
  y4 = ematrix[pleft][H2Oright];

  t = (Pair - (Plower2 + (double)pleft * stepP)) / ((double)(pright - pleft) * stepP);  // 0<=t<=1
  u = (Present_H2O - (H2Olower + (double)H2Oleft * stepH2O)) / ((double)(H2Oright - H2Oleft) * stepH2O); // 0<=u<=1

//  beerfactor is interpolated multiplication factor for Beer's Law correction
  beerfactor = ((1.0-t)*(1.0-u)*y1) + (t*(1.0-u)*y2) + (t*u*y3) + ((1.0-t)*u*y4);    
  
  return  beerfactor;
}
