#
# Makefile for Header API
#
LIBDIR=		${JLOCAL}/lib
MANDIR=		${JLOCAL}/man/man3
INCLUDEDIR=	${JLOCAL}/include
CC=		gcc

LIBNAME=	hdr_api
HEADER=		ctape.h

INCLUDES=	-I${INCLUDEDIR}
DEFINES=	
CFLAGS=		-Wall -g ${INCLUDES} ${DEFINES}

OBJS=	init.o getvarlist.o getsdi.o getstartlen.o getlocn.o\
	getrate.o gethdr.o getaddr.o getname.o getres.o getcof.o getlr.o\
	getdmeaddr.o getblkinfo.o getps.o getintf.o getsn.o getserial.o\
	gethskp.o getnbins.o

SRCS=	init.c getvarlist.c getsdi.c getstartlen.c getlocn.c\
	getrate.c gethdr.c getaddr.c getname.c getres.c getcof.c getlr.c\
	getdmeaddr.c getblkinfo.c getps.c getintf.c getsn.c getserial.c\
	gethskp.c getnbins.c

HDRS=	ctape.h hdr_api.h ${INCLUDEDIR}/raf/header.h

.SUFFIXES: .o .h .c

.c.o:
	${CC} ${CFLAGS} -c $*.c

all: lib${LIBNAME}.a

${OBJS}: ${HDRS}

lib${LIBNAME}.a: ${OBJS}
	rm -f lib${LIBNAME}.a
	ar cr lib${LIBNAME}.a ${OBJS}

install: all
	test -d ${LIBDIR} || mkdir ${LIBDIR}
	test -d ${INCLUDEDIR}/raf || mkdir ${INCLUDEDIR}/raf
	install -p --mode=664  lib${LIBNAME}.a ${LIBDIR}
	install -p --mode=444  ${HEADER} ${INCLUDEDIR}/raf
	test -d ${MANDIR} || mkdir ${MANDIR}
	install -p --mode=664  ${LIBNAME}.3 ${MANDIR}

clean:
	rm -f *.o *.a *.ln
